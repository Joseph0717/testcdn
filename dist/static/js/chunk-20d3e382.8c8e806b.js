(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-20d3e382"],{"2fc4":function(e,t,n){"use strict";n("4de4");var a={name:"MySearch",props:{fields:{type:Array,default:function(){return[]}}},data:function(){return{filter:{field:"",value:"",operator:"Contains"}}},created:function(){this.filter.field=this.fields[0].value},methods:{change:function(e){this.filter.field=e},onSearch:function(e){this.filter.value=e,e=this.filter,this.$emit("click",e)}}};n=n("2877"),a=Object(n.a)(a,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-input-search",{attrs:{allowClear:""},on:{search:e.onSearch}},[n("a-select",{staticStyle:{"min-width":"100px"},attrs:{slot:"addonBefore"},on:{change:e.change},slot:"addonBefore",model:{value:e.filter.field,callback:function(t){e.$set(e.filter,"field",t)},expression:"filter.field"}},[e._l(e.fields,(function(t){return["string"==t.type?n("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")]):e._e()]}))],2),n("a-button",{attrs:{slot:"enterButton",icon:"search"},slot:"enterButton"})],1)],1)}),[],!1,null,null,null);t.a=a.exports},"6c32":function(e,t,n){"use strict";n.r(t),n("4de4"),n("c975"),n("d81d"),n("96cf");var a=n("1da1"),r=n("7424"),s=n("b775");function i(e,t,n){return o.apply(this,arguments)}function o(){return(o=Object(a.a)(regeneratorRuntime.mark((function e(t,n,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s.e)(r.BUSCOLUMNSGETPAGE,s.a.POST,{currentPage:t,pageSize:n,dynamicFilter:a}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){return c.apply(this,arguments)}function c(){return(c=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s.e)(r.BUSCOLUMNSADD,s.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return p.apply(this,arguments)}function p(){return(p=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s.e)(r.BUSCOLUMNSUPDATE,s.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(s.e)(r.BUSCOLUMNSBATCHSOFTDELETE,s.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n("a701"),g=n("2fc4");g={name:"BusColumns",i18n:n("9225"),components:{MySearch:g.a},computed:{fields:function(){return[{value:"dbColumn",label:"业务字段",type:"string"},{value:"columnDesc",label:"字段说明",type:"string"}]}},data:function(){return{minHeight:window.innerHeight-219,busColumnsList:[],businessTypes:[],belongTypes:[],loading:!1,pagination:{currentPage:1,pageSize:100,totalResult:0},dynamicFilter:{},statusList:[{label:"禁用",value:0},{label:"启用",value:1}],validRules:{businessType:[{required:!0,message:"请选择业务类型"}],belongType:[{required:!0,message:"请选择归属类型"}],dbColumn:[{required:!0,message:"请输入业务字段"}]}}},created:function(){this.getDictionary(),this.getBusColumnsList()},methods:{getDictionary:function(){var e=this;Object(m.d)(["BusinessType","BelongType"]).then((function(t){1===t.data.code&&(t=t.data.data,e.businessTypes=t.filter((function(e){return"BusinessType"===e.code}))[0].data,e.belongTypes=t.filter((function(e){return"BelongType"===e.code}))[0].data)}))},getBusColumnsList:function(){var e=this;this.loading=!0,i(this.pagination.currentPage,this.pagination.pageSize,this.dynamicFilter).then((function(t){1===t.data.code&&(e.busColumnsList=t.data.data.list,e.pagination.totalResult=t.data.data.total,e.loading=!1)}))},handlePageChange:function(e){var t=e.currentPage;e=e.pageSize;this.pagination.currentPage=t,this.pagination.pageSize=e,this.getBusColumnsList()},onSearch:function(e){this.dynamicFilter=e,this.pagination.currentPage=1,this.getBusColumnsList()},insert:function(){this.$refs.xTable.insert({})},save:function(){var e=this;return Object(a.a)(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.$refs.xTable,r=n.getRecordset(),a=r.insertRecords,r.removeRecords,r=r.updateRecords,0==a.length&&0==r)return t.abrupt("return",!1);t.next=4;break;case 4:return t.next=6,n.validate(!0).catch((function(e){return e}));case 6:if(t.sent)return t.abrupt("return",!1);t.next=9;break;case 9:e.loading=!0,0<a.length&&(a.reverse(),a.map((function(t){u({status:t.status,businessType:t.businessType,belongType:t.belongType,dbColumn:t.dbColumn,columnDesc:t.columnDesc,remark:t.remark}).then((function(t){1===t.data.code?(e.$message.success("保存成功!"),e.getBusColumnsList()):(e.loading=!1,e.$message.error(t.data.msg))}))}))),0<r.length&&r.map((function(t){l({status:t.status,businessType:t.businessType,belongType:t.belongType,dbColumn:t.dbColumn,columnDesc:t.columnDesc,remark:t.remark,id:t.id,version:1}).then((function(t){1===t.data.code?(e.$message.success("保存成功!"),e.getBusColumnsList()):(e.loading=!1,e.$message.error(t.data.msg))}))}));case 12:case"end":return t.stop()}}),t)})))()},batchDelete:function(){var e=this,t=this.$refs.xTable.getCheckboxRecords();if(0==t.length)return!1;d(t.map((function(e){return e.id}))).then((function(t){1===t.data.code&&e.getBusColumnsList()}))},filterOption:function(e,t){return 0<=t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())}}},n("eb14"),n=n("2877"),g=Object(n.a)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"BusColumns"},[n("vxe-toolbar",{attrs:{custom:"",print:""},scopedSlots:e._u([{key:"tools",fn:function(){return[n("a-space",[n("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:buscolumns:add",expression:"`api:admin:buscolumns:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:e.insert}},[e._v(e._s(e.$t("37")))]),n("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:buscolumns:update",expression:"`api:admin:buscolumns:update`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"save"},on:{click:e.save}},[e._v("保存")]),!e.loading&&0<e.$refs.xTable.getCheckboxRecords().length?n("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:e.batchDelete}},[n("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:buscolumns:batchsoftdelete",expression:"`api:admin:buscolumns:batchsoftdelete`",arg:"permission"}],attrs:{type:"danger",size:"small",icon:"delete"}},[e._v("删除")])],1):e._e(),n("my-search",{attrs:{fields:e.fields},on:{click:e.onSearch}})],1)]},proxy:!0}])}),n("vxe-table",{ref:"xTable",attrs:{"keep-source":"",data:e.busColumnsList,loading:e.loading,"print-config":{},"show-overflow":"",resizable:"",border:"","highlight-hover-row":"",height:e.minHeight,"edit-config":{trigger:"click",mode:"row",showStatus:!0},"edit-rules":e.validRules}},[n("vxe-column",{attrs:{type:"checkbox",width:"50"},scopedSlots:e._u([{key:"header",fn:function(t){var a=t.checked;t=t.indeterminate;return[n("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleAllCheckboxRow()}}},[n("span",t?[n("a-checkbox",{attrs:{indeterminate:!0}})]:a?[n("a-checkbox",{attrs:{checked:!0}})]:[n("a-checkbox")],1)])]}},{key:"checkbox",fn:function(t){var a=t.row,r=t.checked;t=t.indeterminate;return[n("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleCheckboxRow(a)}}},[n("span",t?[n("a-checkbox",{attrs:{indeterminate:!0}})]:r?[n("a-checkbox",{attrs:{checked:!0}})]:[n("a-checkbox")],1)])]}}])}),n("vxe-column",{attrs:{field:"businessType",title:"业务类型","edit-render":{}},scopedSlots:e._u([{key:"edit",fn:function(t){var a=t.row;return[n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","option-filter-prop":"children","filter-option":e.filterOption},model:{value:a.businessType,callback:function(t){e.$set(a,"businessType",t)},expression:"row.businessType"}},e._l(e.businessTypes,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.code}},[e._v(" "+e._s(t.name)+" ")])})),1)]}},{key:"default",fn:function(t){var a=t.row;return[e._l(e.businessTypes,(function(t){return[a.businessType==t.code?n("span",{key:t.id},[e._v(e._s(t.name))]):e._e()]}))]}}])}),n("vxe-column",{attrs:{field:"belongType",title:"归属类型","edit-render":{}},scopedSlots:e._u([{key:"edit",fn:function(t){var a=t.row;return[n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","option-filter-prop":"children","filter-option":e.filterOption},model:{value:a.belongType,callback:function(t){e.$set(a,"belongType",t)},expression:"row.belongType"}},e._l(e.belongTypes,(function(t,a){return n("a-select-option",{key:a,attrs:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)]}},{key:"default",fn:function(t){var a=t.row;return[e._l(e.belongTypes,(function(t){return[a.belongType==t.value?n("span",{key:t.id},[e._v(e._s(t.name))]):e._e()]}))]}}])}),n("vxe-column",{attrs:{field:"dbColumn",title:"业务字段","edit-render":{name:"$input",defaultValue:"",props:{maxlength:20}}}}),n("vxe-column",{attrs:{field:"columnDesc",title:"字段说明","edit-render":{name:"$input",defaultValue:"",props:{maxlength:50}}}}),n("vxe-column",{attrs:{field:"remark",title:"备注","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),n("vxe-column",{attrs:{field:"status",title:"状态","edit-render":{name:"$select",defaultValue:1,options:e.statusList,props:{clearable:!1}}},scopedSlots:e._u([{key:"default",fn:function(t){return t=t.row,[0==t.status?n("a-tag",{attrs:{color:"#f5222d"}},[e._v("禁用")]):e._e(),1==t.status?n("a-tag",{attrs:{color:"#1890ff"}},[e._v("启用")]):e._e()]}}])}),n("vxe-column",{attrs:{width:"60",fixed:"right",title:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[n("a-space",[a.id?e._e():n("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:function(t){return e.$refs.xTable.remove(a)}}},[n("a-tooltip",{attrs:{placement:"top",title:"删除"}},[n("a-button",{attrs:{type:"danger",size:"small",icon:"delete"}})],1)],1)],1)]}}])})],1),n("vxe-pager",{attrs:{"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize,total:e.pagination.totalResult,"page-sizes":[20,50,100,200],layouts:["PrevPage","JumpNumber","NextPage","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1)}),[],!1,null,"41ad3cca",null).exports;t.default=g},eb14:function(e,t,n){"use strict";n("fc2e")},fc2e:function(e,t,n){}}]);