(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-671780f4"],{"58cc":function(t,e,a){},"71e0":function(t,e,a){},7569:function(t,e,a){t.exports=a.p+"static/img/localAvatar.37c3ea6b.png"},"80c1":function(t,e,a){"use strict";a.r(e),a("7db0"),a("d81d"),a("ac1f"),a("1276");var s=a("5530"),o=a("5880"),i={name:"CommonLayout",computed:Object(s.a)({},Object(o.mapState)("setting",["footerLinks","copyright"]))},r=(a("f5f5"),a("2877")),n=Object(r.a)(i,(function(){var t=this,e=t.$createElement;e=t._self._c||e;return e("div",{staticClass:"common-layout beauty-scroll"},[e("div",{staticClass:"content"},[t._t("default")],2)])}),[],!1,null,"40b542ca",null).exports,l=a("93d6"),c=a("b775"),d=a("89a5"),u=a("ca00"),m=(i=a("2ef0"),a.n(i));o={name:"Login",i18n:a("9225"),components:{CommonLayout:n},data:function(){var t=this;return{form:{userName:"",password:"",verifyCode:""},rules:{userName:[{validator:function(e,a,s){""===a?s(new Error(t.$t("5"))):s()},trigger:"change",required:!0}],password:[{validator:function(e,a,s){""===a?s(new Error(t.$t("6"))):s()},trigger:"change",required:!0}],verifyCode:[{validator:function(e,a,s){""===a?s(new Error(t.$t("7"))):s()},trigger:"change",required:!0}]},loading:!1,spin:!1,verifydata:{},routerOptions:[{router:"root",children:[]}],langList:[{key:"CN",name:"简体中文",alias:"简体中文"},{key:"US",name:"English",alias:"English"}]}},computed:Object(s.a)(Object(s.a)({},Object(o.mapState)("setting",["lang","systemName"])),{},{langAlias:function(){var t=this;return this.langList.find((function(e){return e.key==t.lang})).alias}}),created:function(){this.getCode()},mounted:function(){window.addEventListener("keydown",this.keyDown)},destroyed:function(){window.removeEventListener("keydown",this.keyDown,!1)},methods:Object(s.a)(Object(s.a)(Object(s.a)({},Object(o.mapMutations)("account",["setUser","setPermissions","setRoles","setSystemType"])),Object(o.mapMutations)("setting",["setLang"])),{},{getCode:function(){var t=this;this.spin=!0,Object(l.d)(this.verifydata.key).then((function(e){1===e.data.code&&(t.verifydata=e.data.data,t.spin=!1)}))},onSubmit:function(){var t=this;this.$refs.form.validate((function(e){var a,s,o;e&&(t.loading=!0,a=t.form.userName,s=t.form.password,o=t.form.verifyCode,e=t.verifydata.key,Object(l.e)(a,s,"",o,e).then(t.afterLogin).catch((function(){t.loading=!1,t.$message.error(t.$t("8"))})))}))},keyDown:function(t){13!==t.keyCode&&"Enter"!==t.code&&"NumpadEnter"!==t.code||this.onSubmit()},afterLogin:function(t){var e=this,s=t.data;0===s.code?(this.loading=!1,this.$message.error(s.msg)):(t=s.data.token,Object(c.f)({token:t,expireAt:1}),this.setSystemType(s.data.defaultsystemtype),Object(l.n)(99).then((function(t){var s=t.data,o={name:s.data.user.userName,avatar:s.data.user.avatar||a("7569"),belongCode:s.data.user.belongCode,userType:s.data.user.userType,organizationList:s.data.user.organizationList};t=s.data.menus;t.push({closable:!0,external:!1,hidden:!0,icon:"dashboard",id:"Dashboard",label:"Dashboard",labelEn:"Dashboard",newWindow:!1,opened:null,parentId:0,path:"/Dashboard",systemType:null,type:2,viewPath:"/Dashboard"}),e.setUser(o),e.setPermissions([{id:"form",operation:s.data.permissions}]),localStorage.setItem("systemtypes",JSON.stringify(s.data.systemtypes)),localStorage.setItem("currentOrg",s.data.user.organizationList.split(",")[0]);var i=[];t.map((function(t){i.push({id:t.id,parentId:t.parentId,router:"id"+t.id,path:t.path,name:t.label,labelEn:t.labelEn,icon:t.icon,invisible:t.hidden,authority:"form",type:t.type,systemType:t.systemType})})),i.sort(Object(u.a)("sort",!0)),e.routerOptions[0].children=Object(u.g)(m.a.cloneDeep(i)),Object(d.d)(e.routerOptions),e.$router.push("/Dashboard"),e.loading=!1})).catch((function(t){e.loading=!1,e.$message.error(e.$t("9"))})))}})},a("ee76"),o=Object(r.a)(o,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("common-layout",[s("div",{staticClass:"main"},[s("div",{staticClass:"left animated fadeInLeft"},[s("div",{staticClass:"top"},[s("img",{attrs:{src:a("e9e9")}})])]),s("div",{staticClass:"center"}),s("div",{staticClass:"right animated fadeInRight"},[s("div",{staticClass:"top"},[s("a-dropdown",{staticClass:"lang header-item",staticStyle:{cursor:"pointer"}},[s("div",[s("a-icon",{staticStyle:{"vertical-align":"-2px"},attrs:{type:"global"}}),s("span",[t._v(" "+t._s(t.langAlias))])],1),s("a-menu",{attrs:{slot:"overlay","selected-keys":[t.lang]},on:{click:function(e){return t.setLang(e.key)}},slot:"overlay"},t._l(t.langList,(function(e){return s("a-menu-item",{key:e.key},[t._v(t._s(e.key+" "+e.name))])})),1)],1)],1),s("div",{staticClass:"login-box"},[s("a-form-model",{ref:"form",attrs:{model:t.form,rules:t.rules}},[s("div",{staticClass:"logo-box"},[s("h4",[t._v(t._s(t.systemName))])]),s("a-form-model-item",{staticStyle:{width:"100%"},attrs:{label:"",prop:"userName"}},[s("a-input",{attrs:{placeholder:t.$t("2"),size:"large"},model:{value:t.form.userName,callback:function(e){t.$set(t.form,"userName",e)},expression:"form.userName"}},[s("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),s("a-form-model-item",{staticStyle:{width:"100%"},attrs:{label:"",prop:"password"}},[s("a-input-password",{attrs:{placeholder:t.$t("3"),size:"large"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}},[s("a-icon",{attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),s("a-form-model-item",{staticClass:"verify",staticStyle:{width:"100%"},attrs:{label:"",prop:"verifyCode"}},[s("a-input",{attrs:{placeholder:t.$t("4"),size:"large"},model:{value:t.form.verifyCode,callback:function(e){t.$set(t.form,"verifyCode",e)},expression:"form.verifyCode"}}),s("a-button",{attrs:{size:"large"},on:{click:t.getCode}},[t.verifydata.img?s("img",{staticStyle:{width:"70px"},attrs:{src:"data:image/png;base64,"+t.verifydata.img}}):t._e(),s("a-icon",{attrs:{type:"reload",spin:t.spin}})],1)],1),s("a-form-model-item",{staticStyle:{width:"100%"}},[s("a-button",{attrs:{type:"primary",size:"large",block:!0,loading:t.loading},on:{click:t.onSubmit,keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit(e)}}},[t._v(t._s(t.$t("1")))])],1)],1)],1)])])])}),[],!1,null,"67185cc1",null).exports;e.default=o},e9e9:function(t,e,a){t.exports=a.p+"static/img/ys-logo-2.d84c47ae.png"},ee76:function(t,e,a){"use strict";a("71e0")},f5f5:function(t,e,a){"use strict";a("58cc")}}]);