(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4394bef9"],{1032:function(e,t,r){"use strict";r.r(t),r("4de4"),r("4160"),r("c975"),r("d81d"),r("fb6a"),r("a434"),r("b0c0"),r("159b"),r("96cf");var a=r("1da1"),n=r("65cb"),i=r("d010c"),o=r("a701"),s=r("2fc4");s={name:"MawbNoMaster",i18n:r("9225"),components:{MySearch:s.a},computed:{fields:function(){return[{value:"mawbNo",label:"主单号",type:"string"},{value:"carrierCode",label:"承运人代码",type:"string"}]}},data:function(){return{minHeight:window.innerHeight-219,carrierList:[],IETypes:[],mawbNoMasterList:[],loading:!1,pagination:{currentPage:1,pageSize:100,totalResult:0},dynamicFilter:{},validRules:{mawbNo:[{required:!0,message:"请输入主单号"}],ieType:[{required:!0,message:"请选择进出口类型"}],carrierCode:[{required:!0,message:"请选择承运人代码"}]},form:{},rules:{CarrierCode:[{required:!0,message:"请选择承运人代码",trigger:"change"}],IEType:[{required:!0,message:"请选择进出口类型",trigger:"change"}]},visible:!1,confirmLoading:!1,fileList:[]}},created:function(){this.getDictionary(),this.getMawbNoMasterList()},methods:{getDictionary:function(){var e=this;Object(o.d)(["IEType"]).then((function(t){1===t.data.code&&(t=t.data.data,e.IETypes=t.filter((function(e){return"IEType"===e.code}))[0].data)})),Object(i.d)(0).then((function(t){1===t.data.code&&(e.carrierList=t.data.data)}))},getMawbNoMasterList:function(){var e=this;this.loading=!0,Object(n.d)(this.pagination.currentPage,this.pagination.pageSize,this.dynamicFilter).then((function(t){1===t.data.code&&(e.mawbNoMasterList=t.data.data.list,e.pagination.totalResult=t.data.data.total,e.loading=!1)}))},handlePageChange:function(e){var t=e.currentPage;e=e.pageSize;this.pagination.currentPage=t,this.pagination.pageSize=e,this.getMawbNoMasterList()},onSearch:function(e){this.dynamicFilter=e,this.pagination.currentPage=1,this.getMawbNoMasterList()},insert:function(){this.$refs.xTable.insert({isOccupy:0})},save:function(){var e=this;return Object(a.a)(regeneratorRuntime.mark((function t(){var r,a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.$refs.xTable,i=r.getRecordset(),a=i.insertRecords,i.removeRecords,i=i.updateRecords,0==a.length&&0==i)return t.abrupt("return",!1);t.next=4;break;case 4:return t.next=6,r.validate(!0).catch((function(e){return e}));case 6:if(t.sent)return t.abrupt("return",!1);t.next=9;break;case 9:e.loading=!0,0<a.length&&(a.reverse(),a.map((function(t){t={mawbNo:t.mawbNo,ieType:t.ieType,carrierCode:t.carrierCode,isOccupy:t.isOccupy,remark:t.remark},Object(n.a)(t).then((function(t){1===t.data.code?(e.$message.success("保存成功!"),e.getMawbNoMasterList()):(e.loading=!1,e.$message.error(t.data.msg))}))}))),0<i.length&&i.map((function(t){t={mawbNo:t.mawbNo,ieType:t.ieType,carrierCode:t.carrierCode,isOccupy:t.isOccupy,remark:t.remark,id:t.id,version:1},Object(n.e)(t).then((function(t){1===t.data.code?(e.$message.success("保存成功!"),e.getMawbNoMasterList()):(e.loading=!1,e.$message.error(t.data.msg))}))}));case 12:case"end":return t.stop()}}),t)})))()},batchDelete:function(){var e=this,t=this.$refs.xTable.getCheckboxRecords();if(0==t.length)return!1;t=t.map((function(e){return e.id})),Object(n.b)(t).then((function(t){1===t.data.code&&e.getMawbNoMasterList()}))},imported:function(){this.fileList=[],this.form={CarrierCode:"",IEType:""},this.visible=!0},handleOk:function(){var e=this;this.$refs.form.validate((function(t){if(t){if(0==e.fileList.length)return e.$message.error("请选择文件!"),!1;e.confirmLoading=!0;var r=new FormData;e.fileList.forEach((function(e){r.append("file",e)})),r.append("fileparameterjson",JSON.stringify(e.form)),Object(n.f)(r).then((function(t){1===t.data.code?(e.confirmLoading=!1,e.visible=!1,e.$message.success("导入成功!"),e.getMawbNoMasterList()):(e.confirmLoading=!1,e.$message.error(t.data.msg))})).catch((function(t){e.confirmLoading=!1,e.$message.error("系统内部错误!")}))}}))},beforeUpload:function(e){return!(this.fileList=[e])},fileChange:function(e){e.file.size/1024/1024<10||(this.$message.error(e.file.name+":超出限制大小10M!"),this.handleRemove(e.file))},handleRemove:function(e){var t=this.fileList.indexOf(e);e=this.fileList.slice();e.splice(t,1),this.fileList=e}}},r("b9a4"),r=r("2877"),s=Object(r.a)(s,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"MawbNoMaster"},[r("vxe-toolbar",{attrs:{custom:"",print:""},scopedSlots:e._u([{key:"tools",fn:function(){return[r("a-space",[r("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:mawbnomaster:add",expression:"`api:admin:mawbnomaster:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:e.insert}},[e._v(e._s(e.$t("37")))]),r("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:mawbnomaster:uploadmorefileasync",expression:"`api:admin:mawbnomaster:uploadmorefileasync`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"vertical-align-bottom"},on:{click:e.imported}},[e._v("导入")]),r("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:mawbnomaster:update",expression:"`api:admin:mawbnomaster:update`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"save"},on:{click:e.save}},[e._v("保存")]),!e.loading&&0<e.$refs.xTable.getCheckboxRecords().length?r("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:e.batchDelete}},[r("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:mawbnomaster:batchsoftdelete",expression:"`api:admin:mawbnomaster:batchsoftdelete`",arg:"permission"}],attrs:{type:"danger",size:"small",icon:"delete"}},[e._v("删除")])],1):e._e(),r("my-search",{attrs:{fields:e.fields},on:{click:e.onSearch}})],1)]},proxy:!0}])}),r("vxe-table",{ref:"xTable",attrs:{"keep-source":"",data:e.mawbNoMasterList,loading:e.loading,"print-config":{},"show-overflow":"",resizable:"",border:"","highlight-hover-row":"",height:e.minHeight,"edit-config":{trigger:"click",mode:"row",showStatus:!0},"edit-rules":e.validRules}},[r("vxe-column",{attrs:{type:"checkbox",width:"50"},scopedSlots:e._u([{key:"header",fn:function(t){var a=t.checked;t=t.indeterminate;return[r("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleAllCheckboxRow()}}},[r("span",t?[r("a-checkbox",{attrs:{indeterminate:!0}})]:a?[r("a-checkbox",{attrs:{checked:!0}})]:[r("a-checkbox")],1)])]}},{key:"checkbox",fn:function(t){var a=t.row,n=t.checked;t=t.indeterminate;return[r("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleCheckboxRow(a)}}},[r("span",t?[r("a-checkbox",{attrs:{indeterminate:!0}})]:n?[r("a-checkbox",{attrs:{checked:!0}})]:[r("a-checkbox")],1)])]}}])}),r("vxe-column",{attrs:{field:"mawbNo",title:"主单号","edit-render":{name:"$input",defaultValue:"",props:{maxlength:20}}}}),r("vxe-column",{attrs:{field:"ieType",title:"进出口类型","edit-render":{}},scopedSlots:e._u([{key:"edit",fn:function(t){var a=t.row;return[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:""},model:{value:a.ieType,callback:function(t){e.$set(a,"ieType",t)},expression:"row.ieType"}},e._l(e.IETypes,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),1)]}},{key:"default",fn:function(t){var a=t.row;return[e._l(e.IETypes,(function(t,n){return[t.value==a.ieType?r("span",{key:n},[e._v(e._s(t.name))]):e._e()]}))]}}])}),r("vxe-column",{attrs:{field:"carrierCode",title:"承运人代码","edit-render":{}},scopedSlots:e._u([{key:"edit",fn:function(t){var a=t.row;return[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:""},model:{value:a.carrierCode,callback:function(t){e.$set(a,"carrierCode",t)},expression:"row.carrierCode"}},e._l(e.carrierList,(function(t,a){return r("el-option",{key:a,attrs:{label:t.carrierCode+"-"+t.carrierName,value:t.carrierCode}},[e._v(" "+e._s(t.carrierCode)+" - "+e._s(t.carrierName)+" ")])})),1)]}},{key:"default",fn:function(t){var a=t.row;return[e._l(e.carrierList,(function(t,n){return[t.carrierCode==a.carrierCode?r("span",{key:n},[e._v(e._s(t.carrierCode)+" - "+e._s(t.carrierName))]):e._e()]}))]}}])}),r("vxe-column",{attrs:{field:"isOccupy",title:"是否占用"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[r("a-switch",{attrs:{size:"small",checked:0!=t.isOccupy},on:{click:function(e){t.isOccupy=0===t.isOccupy?1:0}}})]}}])}),r("vxe-column",{attrs:{field:"remark",title:"备注","edit-render":{name:"$input",defaultValue:"",props:{maxlength:50}}}}),r("vxe-column",{attrs:{width:"60",fixed:"right",title:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[r("a-space",[a.id?e._e():r("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:function(t){return e.$refs.xTable.remove(a)}}},[r("a-tooltip",{attrs:{placement:"top",title:"删除"}},[r("a-button",{attrs:{type:"danger",size:"small",icon:"delete"}})],1)],1)],1)]}}])})],1),r("vxe-pager",{attrs:{"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize,total:e.pagination.totalResult,"page-sizes":[20,50,100,200],layouts:["PrevPage","JumpNumber","NextPage","Sizes","Total"]},on:{"page-change":e.handlePageChange}}),r("a-modal",{attrs:{visible:e.visible,title:"导入主单号","confirm-loading":e.confirmLoading,maskClosable:!1,destroyOnClose:!0,centered:""},on:{cancel:function(t){e.visible=!1},ok:e.handleOk}},[r("template",{slot:"closeIcon"},[r("a-button",{attrs:{type:"danger",size:"small",shape:"circle",icon:"close-circle"}})],1),r("a-form-model",{ref:"form",attrs:{model:e.form,rules:e.rules}},[r("a-form-model-item",{attrs:{label:"承运人代码",prop:"CarrierCode"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:""},model:{value:e.form.CarrierCode,callback:function(t){e.$set(e.form,"CarrierCode",t)},expression:"form.CarrierCode"}},e._l(e.carrierList,(function(t,a){return r("el-option",{key:a,attrs:{label:t.carrierCode+"-"+t.carrierName,value:t.carrierCode}},[e._v(" "+e._s(t.carrierCode)+" - "+e._s(t.carrierName)+" ")])})),1)],1),r("a-form-model-item",{attrs:{label:"进出口类型",prop:"IEType"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:""},model:{value:e.form.IEType,callback:function(t){e.$set(e.form,"IEType",t)},expression:"form.IEType"}},e._l(e.IETypes,(function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),1)],1),r("a-form-model-item",[r("a-upload-dragger",{attrs:{"file-list":e.fileList,showUploadList:!0,directory:!1,multiple:!1,"before-upload":e.beforeUpload,remove:e.handleRemove},on:{change:e.fileChange}},[r("p",{staticClass:"ant-upload-drag-icon"},[r("a-icon",{attrs:{type:"inbox"}})],1),r("p",{staticClass:"ant-upload-text"},[e._v("单击或拖动文件到此区域")])])],1)],1)],2)],1)}),[],!1,null,"eb8c1abe",null).exports;t.default=s},"2fc4":function(e,t,r){"use strict";r("4de4");var a={name:"MySearch",props:{fields:{type:Array,default:function(){return[]}}},data:function(){return{filter:{field:"",value:"",operator:"Contains"}}},created:function(){this.filter.field=this.fields[0].value},methods:{change:function(e){this.filter.field=e},onSearch:function(e){this.filter.value=e,e=this.filter,this.$emit("click",e)}}};r=r("2877"),a=Object(r.a)(a,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("a-input-search",{attrs:{allowClear:""},on:{search:e.onSearch}},[r("a-select",{staticStyle:{"min-width":"100px"},attrs:{slot:"addonBefore"},on:{change:e.change},slot:"addonBefore",model:{value:e.filter.field,callback:function(t){e.$set(e.filter,"field",t)},expression:"filter.field"}},[e._l(e.fields,(function(t){return["string"==t.type?r("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")]):e._e()]}))],2),r("a-button",{attrs:{slot:"enterButton",icon:"search"},slot:"enterButton"})],1)],1)}),[],!1,null,null,null);t.a=a.exports},"65cb":function(e,t,r){"use strict";r.d(t,"d",(function(){return o})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return m})),r.d(t,"f",(function(){return b}));t=r("96cf");var a=r("1da1"),n=r("7424"),i=r("b775");function o(e,t,r){return s.apply(this,arguments)}function s(){return(s=Object(a.a)(regeneratorRuntime.mark((function e(t,r,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.MAWBNOMASTERGETPAGE,i.a.POST,{currentPage:t,pageSize:r,dynamicFilter:a}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.MAWBNOMASTERADD,i.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return p.apply(this,arguments)}function p(){return(p=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.MAWBNOMASTERUPDATE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.MAWBNOMASTERBATCHSOFTDELETE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return h.apply(this,arguments)}function h(){return(h=Object(a.a)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.MAWBNOMASTERGETMAWBNOASYNC,i.a.GET,{carriercode:t,bussinesstype:r}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return g.apply(this,arguments)}function g(){return(g=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.MAWBNOMASTERUPLOADMOREFILEASYNC,i.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},b9a4:function(e,t,r){"use strict";r("df15")},d010c:function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"a",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"f",(function(){return d})),r.d(t,"b",(function(){return m})),r.d(t,"d",(function(){return b}));t=r("96cf");var a=r("1da1"),n=r("7424"),i=r("b775");function o(e,t,r){return s.apply(this,arguments)}function s(){return(s=Object(a.a)(regeneratorRuntime.mark((function e(t,r,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.CARRIERGETPAGE,i.a.POST,{currentPage:t,pageSize:r,dynamicFilter:a}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.CARRIERADD,i.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return p.apply(this,arguments)}function p(){return(p=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.CARRIERGET,i.a.GET,{id:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return f.apply(this,arguments)}function f(){return(f=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.CARRIERUPDATE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.CARRIERBATCHSOFTDELETE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){return g.apply(this,arguments)}function g(){return(g=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(n.CARRIERGETCARRIERCACHEPORT,i.a.GET,{type:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},df15:function(e,t,r){}}]);