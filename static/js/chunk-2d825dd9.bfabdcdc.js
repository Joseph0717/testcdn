(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d825dd9"],{"0cc8":function(e,t,n){"use strict";n.r(t),n("d9e2"),n("d81d"),n("b0c0"),n("a4d3"),n("e01a");var a=n("8c16"),r=n("ca00"),i={name:"ViewCom",data:function(){var e=this;return{viewList:[],columns:[{title:"视图名",dataIndex:"label",scopedSlots:{customRender:"label"}},{title:"编号",dataIndex:"id",scopedSlots:{customRender:"id"}},{title:"视图地址",dataIndex:"path",scopedSlots:{customRender:"path"}},{title:"状态",dataIndex:"enabled",scopedSlots:{customRender:"enabled"}},{title:"操作",scopedSlots:{customRender:"operation"}}],loading:!1,title:"",visible:!1,confirmLoading:!1,form:{},spinning:!1,type:"",modules:[],parentIds:[],rules:{parent:[{validator:function(t,n,a){0==e.parentIds.length?a(new Error("请选择所属模块")):a()},trigger:"change",required:!0}],label:[{validator:function(e,t,n){""===t?n(new Error("视图名称不能为空")):n()},trigger:"change",required:!0}],path:[{validator:function(e,t,n){""===t?n(new Error("请输入视图地址")):n()},trigger:"change",required:!0}]}}},created:function(){this.getViewList(),this.getModules()},methods:{getViewList:function(e){var t=this;this.loading=!0,Object(a.c)(e).then((function(e){1===e.data.code&&(t.viewList=Object(r.g)(e.data.data),t.loading=!1)}))},getModules:function(){var e=this;Object(a.c)().then((function(t){1===t.data.code&&(e.modules=Object(r.g)(t.data.data,{id:0,parentId:0,label:"根节点"}))}))},onSearch:function(e){this.getViewList(e)},showModalAdd:function(){this.title="新增视图",this.visible=!0,this.type="add",this.parentIds=[],this.form={parentId:0,name:"",label:"",path:"",description:"",enabled:!0}},showModalEdit:function(e){var t=this;this.title="编辑视图",this.visible=!0,this.spinning=!0,this.type="edit",Object(a.b)(e.id).then((function(e){var n;1===e.data.code&&(e=e.data.data,n=Object(r.c)(t.viewList,e.id),t.parentIds=n.map((function(e){return e.id})),t.parentIds.unshift(0),t.form={parentId:t.parentIds[t.parentIds.length-1],name:e.name,label:e.label,path:e.path,enabled:e.enabled,description:e.description,id:e.id,version:0},t.spinning=!1)}))},handelOk:function(){var e=this;this.confirmLoading=!0,this.$refs.form.validate((function(t){if(!t)return e.confirmLoading=!1;"edit"==e.type?Object(a.e)(e.form).then((function(t){1===t.data.code&&(e.getViewList(),e.getModules(),e.confirmLoading=!1,e.visible=!1)})):Object(a.a)(e.form).then((function(t){1===t.data.code&&(e.getViewList(),e.getModules(),e.confirmLoading=!1,e.visible=!1)}))}))},confirmDelete:function(e){var t=this;Object(a.d)(e.id).then((function(e){1===e.data.code&&(t.getViewList(),t.getModules(),t.confirmLoading=!1,t.visible=!1)}))},handelCancel:function(){this.visible=!1},cascaderChange:function(e){this.form.parentId=e[e.length-1],this.parentIds=e}}};n("a6d7"),n=n("2877"),n=Object(n.a)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"ViewCom"},[n("a-page-header",[n("template",{slot:"extra"},[n("a-button-group",[n("a-input-search",{staticStyle:{width:"200px"},attrs:{placeholder:"请输入关键字","enter-button":""},on:{search:e.onSearch}}),n("a-tooltip",[n("template",{slot:"title"},[e._v("新增")]),n("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:view:add",expression:"`api:admin:view:add`",arg:"permission"}],attrs:{type:"primary",icon:"plus-circle"},on:{click:e.showModalAdd}})],2)],1)],1)],2),n("a-table",{attrs:{columns:e.columns,"data-source":e.viewList,loading:e.loading,pagination:!1,rowKey:"id",bordered:"",size:"small"},scopedSlots:e._u([{key:"enabled",fn:function(t){return n("span",{},[n("a-tag",{attrs:{color:t?"#108ee9":"#f50"}},[e._v(e._s(t?"启用":"禁用"))])],1)}},{key:"operation",fn:function(t){return n("span",{},[n("a-space",[n("a-button",{attrs:{type:"primary",size:"small",icon:"edit"},on:{click:function(n){return e.showModalEdit(t)}}},[e._v("编辑")]),n("a-popconfirm",{attrs:{title:"Sure to delete?","cancel-text":"取消"},on:{confirm:function(n){return e.confirmDelete(t)}}},[n("a-button",{attrs:{type:"danger",size:"small",icon:"delete"}},[e._v("删除")])],1)],1)],1)}}])}),n("a-modal",{attrs:{destroyOnClose:!0,title:e.title,centered:"",visible:e.visible,"confirm-loading":e.confirmLoading,maskClosable:!1},on:{ok:e.handelOk,cancel:e.handelCancel}},[n("template",{slot:"closeIcon"},[n("a-button",{attrs:{type:"danger",size:"small",shape:"circle",icon:"close-circle"}})],1),n("a-spin",{attrs:{spinning:e.spinning}},[n("a-form-model",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-col":{span:4},"wrapper-col":{span:20}}},[n("a-form-model-item",{attrs:{label:"所属模块",prop:"parent"}},[n("a-cascader",{attrs:{"field-names":{label:"label",value:"id",children:"children"},options:e.modules,value:e.parentIds,placeholder:"Please select","change-on-select":""},on:{change:e.cascaderChange}})],1),n("a-form-model-item",{attrs:{label:"视图名",prop:"label"}},[n("a-input",{model:{value:e.form.label,callback:function(t){e.$set(e.form,"label",t)},expression:"form.label"}})],1),n("a-form-model-item",{attrs:{label:"视图地址",prop:"path"}},[n("a-input",{model:{value:e.form.path,callback:function(t){e.$set(e.form,"path",t)},expression:"form.path"}})],1),n("a-form-model-item",{attrs:{label:"启用"}},[n("a-switch",{attrs:{checked:e.form.enabled,size:"small"},on:{click:function(t){e.form.enabled=!e.form.enabled}}})],1),n("a-form-model-item",{attrs:{label:"说明"}},[n("a-input",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1)],2)],1)}),[],!1,null,null,null);t.default=n.exports},"28f3":function(e,t,n){},"8c16":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return m}));var a=n("1da1"),r=(n("96cf"),n("7424")),i=n("b775");function o(e){return s.apply(this,arguments)}function s(){return(s=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.VIEWGETLIST,i.a.GET,{key:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return l.apply(this,arguments)}function l(){return(l=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.VIEWGET,i.a.GET,{id:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return u.apply(this,arguments)}function u(){return(u=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.VIEWUPDATE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.VIEWADD,i.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.VIEWSOFTDELETE,i.a.DELETE,{id:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},a6d7:function(e,t,n){"use strict";n("28f3")}}]);