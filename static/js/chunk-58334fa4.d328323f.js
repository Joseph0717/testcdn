(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-58334fa4"],{"0113":function(e,t,a){},"162d":function(e,t,a){"use strict";a.d(t,"f",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return l})),a.d(t,"g",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"d",(function(){return h})),a.d(t,"e",(function(){return v}));t=a("96cf");var n=a("1da1"),r=a("7424"),i=a("b775");function o(e,t,a){return s.apply(this,arguments)}function s(){return(s=Object(n.a)(regeneratorRuntime.mark((function e(t,a,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUOTATIONGETPAGE,i.a.POST,{currentPage:t,pageSize:a,dynamicFilter:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUOTATIONADD,i.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return(d=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUOTATIONGET,i.a.GET,{id:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUOTATIONUPDATE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUOTATIONBATCHSOFTDELETE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e,t,a){return b.apply(this,arguments)}function b(){return(b=Object(n.a)(regeneratorRuntime.mark((function e(t,a,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUOTATIONGETBYCOLSMAPPINGASYNC,i.a.GET,{businesstype:t,orgId:a,quotationid:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e,t){return y.apply(this,arguments)}function y(){return(y=Object(n.a)(regeneratorRuntime.mark((function e(t,a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUOTATIONGETCOLUMNSBYBUSASYNC,i.a.GET,{businesstype:t,orgId:a}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},"4c2d":function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"e",(function(){return l})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return m}));t=a("96cf");var n=a("1da1"),r=a("7424"),i=a("b775");function o(e,t,a){return s.apply(this,arguments)}function s(){return(s=Object(n.a)(regeneratorRuntime.mark((function e(t,a,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.SEQUENCERULEGETPAGE,i.a.POST,{currentPage:t,pageSize:a,dynamicFilter:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function c(e){return u.apply(this,arguments)}function u(){return(u=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.SEQUENCERULEADD,i.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return d.apply(this,arguments)}function d(){return(d=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.SEQUENCERULEUPDATE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e){return f.apply(this,arguments)}function f(){return(f=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.SEQUENCERULEBATCHSOFTDELETE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return g.apply(this,arguments)}function g(){return(g=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.SEQUENCERULEGETAUTORULECODE,i.a.GET,{autorulecode:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},"55f3":function(e,t,a){"use strict";a("8323")},"7d84":function(e,t,a){},8323:function(e,t,a){},a6a0:function(e,t,a){"use strict";a("7d84")},b19f:function(e,t,a){"use strict";a("0113")},e9d6:function(e,t,a){"use strict";a.r(t),a("4de4"),a("d81d"),a("96cf");var n=a("1da1"),r=a("162d"),i=a("4c2d"),o=a("a701"),s=a("7424"),c=a("b775");function u(e){return l.apply(this,arguments)}function l(){return(l=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONLINEADD,c.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return(p=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONLINEGET,c.a.GET,{id:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return m.apply(this,arguments)}function m(){return(m=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONLINEUPDATE,c.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return(h=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONLINEBATCHSOFTDELETE,c.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONLINEGETLINEBYQUOTATIONIDASYNC,c.a.GET,{quotationid:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return y.apply(this,arguments)}function y(){return(y=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONRATEADD,c.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return x.apply(this,arguments)}function x(){return(x=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONRATEUPDATE,c.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e){return w.apply(this,arguments)}function w(){return(w=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONRATEBATCHSOFTDELETE,c.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e){return R.apply(this,arguments)}function R(){return(R=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(c.e)(s.QUOTATIONRATEGETBYQUTATIONLINEIDASYNC,c.a.GET,{quotationlineid:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=a("c32d"),C=a.n(D),_={name:"QuotationRate",i18n:a("9225"),components:{},computed:{},props:{quotationLineId:{type:String,default:"0"}},data:function(){return{minHeight:window.innerHeight-219,quotationRateList:[],loading:!1,validRules:{startDate:[{required:!0,message:"请选择起始日期"}],endDate:[{required:!0,message:"请选择结束日期"}],rate:[{required:!0,message:"请输入费率"}],break:[{required:!0,message:"请输入Break"}]}}},created:function(){this.getDictionary(),this.getQuotationRateList()},methods:{moment:C.a,getDictionary:function(){},getQuotationRateList:function(){var e=this;this.loading=!0,O(this.quotationLineId).then((function(t){1===t.data.code&&(e.quotationRateList=t.data.data,e.loading=!1)}))},dateChange:function(e,t,a){a.startDate=a.startDate?C()(new Date(t),"YYYY-MM-DD"):""},dateChange1:function(e,t,a){a.endDate=a.endDate?C()(new Date(t),"YYYY-MM-DD"):""},insert:function(){var e={quotationLineId:this.quotationLineId};this.$refs.xTable.insert(e)},save:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.$refs.xTable,r=a.getRecordset(),n=r.insertRecords,r.removeRecords,r=r.updateRecords,0==n.length&&0==r)return t.abrupt("return",!1);t.next=4;break;case 4:return t.next=6,a.validate(!0).catch((function(e){return e}));case 6:if(t.sent)return t.abrupt("return",!1);t.next=9;break;case 9:e.loading=!0,0<n.length&&(n.reverse(),n.map((function(t){v({startDate:t.startDate,endDate:t.endDate,rate:t.rate,break:t.break,remark:t.remark,quotationLineId:t.quotationLineId}).then((function(t){1===t.data.code?(e.$message.success("保存成功!"),e.getQuotationRateList()):(e.loading=!1,e.$message.error(t.data.msg))}))}))),0<r.length&&r.map((function(t){k({startDate:t.startDate,endDate:t.endDate,rate:t.rate,break:t.break,remark:t.remark,quotationLineId:t.quotationLineId,id:t.id,version:1}).then((function(t){1===t.data.code?(e.$message.success("保存成功!"),e.getQuotationRateList()):(e.loading=!1,e.$message.error(t.data.msg))}))}));case 12:case"end":return t.stop()}}),t)})))()},batchDelete:function(){var e=this,t=this.$refs.xTable.getCheckboxRecords();if(0==t.length)return!1;T(t.map((function(e){return e.id}))).then((function(t){1===t.data.code&&e.getQuotationRateList()}))}}};a("55f3"),D=a("2877"),_=Object(D.a)(_,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QuotationRate"},[a("div",{staticStyle:{display:"flex","justify-content":"flex-end","margin-bottom":"5px"}},[a("a-space",[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:quotationrate:add",expression:"`api:admin:quotationrate:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:e.insert}},[e._v(e._s(e.$t("37")))]),a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:quotationrate:add",expression:"`api:admin:quotationrate:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"save"},on:{click:e.save}},[e._v("保存")]),!e.loading&&0<e.$refs.xTable.getCheckboxRecords().length?a("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:e.batchDelete}},[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:quotationrate:batchsoftdelete",expression:"`api:admin:quotationrate:batchsoftdelete`",arg:"permission"}],attrs:{type:"danger",size:"small",icon:"delete"}},[e._v("删除")])],1):e._e()],1)],1),a("vxe-table",{ref:"xTable",attrs:{"keep-source":"",data:e.quotationRateList,loading:e.loading,"print-config":{},"show-overflow":"",resizable:"",border:"","highlight-hover-row":"",height:e.minHeight,"edit-config":{trigger:"click",mode:"row",showStatus:!0},"edit-rules":e.validRules}},[a("vxe-column",{attrs:{type:"checkbox",width:"50"},scopedSlots:e._u([{key:"header",fn:function(t){var n=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleAllCheckboxRow()}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:n?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}},{key:"checkbox",fn:function(t){var n=t.row,r=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleCheckboxRow(n)}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:r?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}}])}),a("vxe-column",{attrs:{field:"startDate",title:"起始日期","edit-render":{}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"},on:{change:function(t,a){return e.dateChange(t,a,n)}},model:{value:n.startDate,callback:function(t){e.$set(n,"startDate",t)},expression:"row.startDate"}})]}},{key:"default",fn:function(t){return t=t.row,[a("span",[e._v(e._s(t.startDate?e.moment(t.startDate).format("YYYY-MM-DD"):""))])]}}])}),a("vxe-column",{attrs:{field:"endDate",title:"结束日期","edit-render":{}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"},on:{change:function(t,a){return e.dateChange1(t,a,n)}},model:{value:n.endDate,callback:function(t){e.$set(n,"endDate",t)},expression:"row.endDate"}})]}},{key:"default",fn:function(t){return t=t.row,[a("span",[e._v(e._s(t.endDate?e.moment(t.endDate).format("YYYY-MM-DD"):""))])]}}])}),a("vxe-column",{attrs:{field:"rate",title:"费率","edit-render":{name:"$input",defaultValue:0,props:{type:"number"}}}}),a("vxe-column",{attrs:{field:"break",title:"Break","edit-render":{name:"$input",defaultValue:"",props:{maxlength:50}}}}),a("vxe-column",{attrs:{field:"remark",title:"备注","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{width:"60",fixed:"right",title:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a-space",[n.id?e._e():a("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:function(t){return e.$refs.xTable.remove(n)}}},[a("a-tooltip",{attrs:{placement:"top",title:"删除"}},[a("a-button",{attrs:{type:"danger",size:"small",icon:"delete"}})],1)],1)],1)]}}])})],1)],1)}),[],!1,null,"713ae76a",null).exports,_={name:"QuotationLine",i18n:a("9225"),components:{QuotationRate:_},props:{ID:{type:String,default:"0"},dynamicFields:{type:Array,default:function(){return[]}}},data:function(){return{minHeight:window.innerHeight-340,quotationLineList:[],chargeModes:[],chargeBasiss:[],taskTypes:[],loading:!1,visible:!1,title:"",type:"",confirmLoading:!1,spinning:!1,disabled:!1,form:{},rules:{chargeRoute:[{required:!0,message:"请输入计费线路",trigger:"change"}],chargeCode:[{required:!0,message:"请输入计费科目",trigger:"change"}],serviceType:[{required:!0,message:"请选择服务类型",trigger:"change"}],chargeBasis:[{required:!0,message:"请选择计费基准",trigger:"change"}],chargeMode:[{required:!0,message:"请选择计费模式",trigger:"change"}]},visible1:!1,quotationLineId:0}},created:function(){this.getDictionary(),this.getQuotationLine()},methods:{getDictionary:function(){var e=this;Object(o.d)(["ChargeMode","ChargeBasis","TaskType"]).then((function(t){1===t.data.code&&(t=t.data.data,e.chargeModes=t.filter((function(e){return"ChargeMode"===e.code}))[0].data,e.chargeBasiss=t.filter((function(e){return"ChargeBasis"===e.code}))[0].data,e.taskTypes=t.filter((function(e){return"TaskType"===e.code}))[0].data)}))},getQuotationLine:function(){var e=this;this.loading=!0,function(){return b.apply(this,arguments)}(this.ID).then((function(t){1===t.data.code&&(e.quotationLineList=t.data.data,e.loading=!1)}))},add:function(){var e=this;this.title="新增",this.type="add",this.visible=!0,this.form={quotationId:this.ID,chargeRoute:"",serviceType:"",chargeCode:"",chargeBasis:"",chargeMode:"",remark:""},this.dynamicFields.map((function(t){e.form[t.field]=""}))},edit:function(e){var t=this;this.title="编辑",this.type="edit",this.visible=!0,this.spinning=!0,this.disabled=!0,d(e.id).then((function(e){1===e.data.code&&(t.form=e.data.data,t.spinning=!1,t.disabled=!1)}))},handleOk:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.confirmLoading=!0,"add"==e.type?u(e.form).then((function(t){1===t.data.code?(e.visible=!1,e.confirmLoading=!1,e.getQuotationLine()):(e.$message.error(t.data.msg),e.confirmLoading=!1)})):f(e.form).then((function(t){1===t.data.code?(e.visible=!1,e.confirmLoading=!1,e.getQuotationLine()):(e.$message.error(t.data.msg),e.confirmLoading=!1)})))}))},batchDelete:function(){var e=this,t=this.$refs.xTable.getCheckboxRecords();if(0==t.length)return!1;g(t.map((function(e){return e.id}))).then((function(t){1===t.data.code&&e.getQuotationLine()}))},showRate:function(e){this.quotationLineId=e.id,this.visible1=!0}}},a("b19f"),_={name:"QuotationDetail",components:{QuotationLine:Object(D.a)(_,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QuotationLine"},[a("div",{staticStyle:{display:"flex","justify-content":"flex-end","margin-bottom":"5px"}},[a("a-space",[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:quotationline:add",expression:"`api:admin:quotationline:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:e.add}},[e._v("新增")]),!e.loading&&0<e.$refs.xTable.getCheckboxRecords().length?a("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:e.batchDelete}},[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:quotationline:batchsoftdelete",expression:"`api:admin:quotationline:batchsoftdelete`",arg:"permission"}],attrs:{type:"danger",size:"small",icon:"delete"}},[e._v("删除")])],1):e._e()],1)],1),a("vxe-table",{ref:"xTable",attrs:{"keep-source":"",data:e.quotationLineList,loading:e.loading,"print-config":{},"show-overflow":"",resizable:"",border:"","highlight-hover-row":"",height:e.minHeight}},[a("vxe-column",{attrs:{type:"checkbox",width:"50"},scopedSlots:e._u([{key:"header",fn:function(t){var n=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleAllCheckboxRow()}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:n?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}},{key:"checkbox",fn:function(t){var n=t.row,r=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleCheckboxRow(n)}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:r?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}}])}),a("vxe-column",{attrs:{field:"chargeRoute",title:"计费线路"}}),a("vxe-column",{attrs:{field:"serviceType",title:"服务类型"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._l(e.taskTypes,(function(t){return[n.serviceType==t.value?a("span",{key:t.code},[e._v(e._s(t.name))]):e._e()]}))]}}])}),a("vxe-column",{attrs:{field:"chargeCode",title:"计费科目"}}),e._l(e.dynamicFields,(function(e){return a("vxe-column",{key:e.key,attrs:{field:e.field,title:e.title}})})),a("vxe-column",{attrs:{field:"chargeBasis",title:"计费基准"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._l(e.chargeBasiss,(function(t){return[n.chargeBasis==t.value?a("span",{key:t.code},[e._v(e._s(t.name))]):e._e()]}))]}}])}),a("vxe-column",{attrs:{field:"chargeMode",title:"计费模式"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._l(e.chargeModes,(function(t){return[n.chargeMode==t.value?a("span",{key:t.code},[e._v(e._s(t.name))]):e._e()]}))]}}])}),a("vxe-column",{attrs:{field:"remark",title:"备注"}}),a("vxe-column",{attrs:{width:"100",fixed:"right",title:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a-space",[a("a-tooltip",{attrs:{placement:"top",title:"编辑"}},[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:quotationline:update",expression:"`api:admin:quotationline:update`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"edit"},on:{click:function(t){return e.edit(n)}}})],1),a("a-tooltip",{attrs:{placement:"top",title:"报价费率"}},[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:quotationrate:add",expression:"`api:admin:quotationrate:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"eye"},on:{click:function(t){return e.showRate(n)}}})],1)],1)]}}])})],2),a("a-modal",{attrs:{width:900,visible:e.visible,title:e.title,"confirm-loading":e.confirmLoading,maskClosable:!1,destroyOnClose:!0,"ok-button-props":{props:{disabled:e.disabled}},centered:""},on:{cancel:function(t){e.visible=!1},ok:e.handleOk}},[a("template",{slot:"closeIcon"},[a("a-button",{attrs:{type:"danger",size:"small",shape:"circle",icon:"close-circle"}})],1),a("a-spin",{attrs:{spinning:e.spinning}},[a("a-form-model",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("a-row",{attrs:{gutter:[0,0]}},[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"计费线路",prop:"chargeRoute"}},[a("a-input",{attrs:{"max-length":20},model:{value:e.form.chargeRoute,callback:function(t){e.$set(e.form,"chargeRoute",t)},expression:"form.chargeRoute"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"计费科目",prop:"chargeCode"}},[a("a-input",{attrs:{"max-length":20},model:{value:e.form.chargeCode,callback:function(t){e.$set(e.form,"chargeCode",t)},expression:"form.chargeCode"}})],1)],1)],1),a("a-row",{attrs:{gutter:[0,0]}},[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"服务类型",prop:"serviceType"}},[a("a-select",{model:{value:e.form.serviceType,callback:function(t){e.$set(e.form,"serviceType",t)},expression:"form.serviceType"}},e._l(e.taskTypes,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"计费基准",prop:"chargeBasis"}},[a("a-select",{model:{value:e.form.chargeBasis,callback:function(t){e.$set(e.form,"chargeBasis",t)},expression:"form.chargeBasis"}},e._l(e.chargeBasiss,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value.toString()}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1)],1),a("a-row",{attrs:{gutter:[0,0]}},[a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"计费模式",prop:"chargeMode"}},[a("a-select",{model:{value:e.form.chargeMode,callback:function(t){e.$set(e.form,"chargeMode",t)},expression:"form.chargeMode"}},e._l(e.chargeModes,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[a("a-input",{attrs:{"max-length":200},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1)],1),a("a-row",{attrs:{gutter:[0,0]}},e._l(e.dynamicFields,(function(t){return a("a-col",{key:t.key,attrs:{span:12}},[a("a-form-model-item",{attrs:{label:t.title}},[a("vxe-input",{staticStyle:{width:"100%"},model:{value:e.form[t.field],callback:function(a){e.$set(e.form,t.field,a)},expression:"form[i.field]"}})],1)],1)})),1)],1)],1)],2),a("a-modal",{attrs:{width:900,visible:e.visible1,title:"报价费率",maskClosable:!1,destroyOnClose:!0,footer:null,centered:""},on:{cancel:function(t){e.visible1=!1}}},[a("template",{slot:"closeIcon"},[a("a-button",{attrs:{type:"danger",size:"small",shape:"circle",icon:"close-circle"}})],1),a("QuotationRate",{attrs:{quotationLineId:e.quotationLineId.toString()}})],2)],1)}),[],!1,null,"785a7f0e",null).exports},data:function(){return{ID:this.$route.query.id,businessTypes:[],ARAPs:[],quotationTypes:[],save_loading:!1,form:{status:0,quotationNo:"",quotationDesc:"",businessType:"",partnerCode:"",rpType:"",remark:"",busColsMappingDetail:[]},rules:{quotationNo:[{required:!0,message:"请输入报价编码",trigger:"change"}],quotationDesc:[{required:!0,message:"请输入描述",trigger:"change"}],businessType:[{required:!0,message:"请选择业务类型",trigger:"change"}],rpType:[{required:!0,message:"请选择收付类型",trigger:"change"}]},minHeight:window.innerHeight-310,busColsMappingList:[],mippingTypes:[],loading:!1,statusList:[{label:"禁用",value:0},{label:"启用",value:1}],validRules:{chargeColumn:[{required:!0,message:"请输入计费字段"}],chargeColumnDesc:[{required:!0,message:"请输入计费字段描述"}],businessColumn:[{required:!0,message:"请选择业务字段"}]},columnsByBusAsync:[],dynamicFields:[]}},created:function(){var e=this;this.getDictionary(),"0"!==this.ID?this.getQuotation():Object(i.c)("QuotationNoRule").then((function(t){1===t.data.code&&(e.form.quotationNo=t.data.data.rtRuleCode)}))},methods:{getDictionary:function(){var e=this;Object(o.d)(["BusinessType","ARAP","QuotationType","MippingType"]).then((function(t){1===t.data.code&&(t=t.data.data,e.businessTypes=t.filter((function(e){return"BusinessType"===e.code}))[0].data,e.ARAPs=t.filter((function(e){return"ARAP"===e.code}))[0].data,e.quotationTypes=t.filter((function(e){return"QuotationType"===e.code}))[0].data,e.mippingTypes=t.filter((function(e){return"MippingType"===e.code}))[0].data)}))},getQuotation:function(){var e=this;Object(r.c)(this.ID).then((function(t){1===t.data.code&&(e.form=t.data.data,e.getBusColsMappingList(e.form.businessType,e.form.id),e.getColumnsByBusAsync(e.form.businessType))}))},getBusColsMappingList:function(e,t){var a=this;this.loading=!0,Object(r.d)(e,localStorage.getItem("currentOrg"),t).then((function(e){1===e.data.code&&(a.busColsMappingList=e.data.data,t&&(a.dynamicFields=[],a.busColsMappingList.map((function(e,t){1==e.status&&a.dynamicFields.push({key:t,field:e.chargeColumn,title:e.chargeColumnDesc})}))),a.loading=!1)}))},getColumnsByBusAsync:function(e){var t=this;Object(r.e)(e,localStorage.getItem("currentOrg")).then((function(e){1===e.data.code&&(t.columnsByBusAsync=e.data.data)}))},change:function(e){this.getBusColsMappingList(e),this.getColumnsByBusAsync(e)},change1:function(e,t){var a=this.columnsByBusAsync.filter((function(t){return t.dbColumn===e}))[0];t.businessColumnDesc=a.columnDesc},save:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.$refs.xTable,n=a.getRecordset(),n.insertRecords,n.removeRecords,n.updateRecords,t.next=4,a.validate(!0).catch((function(e){return e}));case 4:i=t.sent,e.$refs.form.validate((function(t){t&&!i&&(e.save_loading=!0,0==e.ID?(e.form.busColsMappingDetail=e.$refs.xTable.getTableData().tableData,Object(r.a)(e.form).then((function(t){1===t.data.code?(e.ID=t.data.data,e.save_loading=!1,e.$message.success("保存成功!"),e.getQuotation()):(e.$message.error(t.data.msg),e.save_loading=!1)}))):Object(r.g)(e.form).then((function(t){1===t.data.code?(e.save_loading=!1,e.$message.success("保存成功!"),e.getQuotation()):(e.$message.error(t.data.msg),e.save_loading=!1)})))}));case 6:case"end":return t.stop()}}),t)})))()}}},a("a6a0"),_=Object(D.a)(_,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QuotationDetail"},[a("div",{staticStyle:{display:"flex","justify-content":"flex-end"}},[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:quotation:add",expression:"`api:admin:quotation:add`",arg:"permission"}],staticStyle:{"margin-bottom":"0px"},attrs:{type:"primary",loading:e.save_loading},on:{click:e.save}},[e._v("保存")])],1),a("a-form-model",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("a-row",{attrs:{gutter:[0,0]}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"报价编码",prop:"quotationNo"}},[a("a-input",{attrs:{"max-length":30,disabled:""},model:{value:e.form.quotationNo,callback:function(t){e.$set(e.form,"quotationNo",t)},expression:"form.quotationNo"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"描述",prop:"quotationDesc"}},[a("a-input",{attrs:{"max-length":50},model:{value:e.form.quotationDesc,callback:function(t){e.$set(e.form,"quotationDesc",t)},expression:"form.quotationDesc"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"业务类型",prop:"businessType"}},[a("a-select",{attrs:{disabled:"0"!=e.ID},on:{change:e.change},model:{value:e.form.businessType,callback:function(t){e.$set(e.form,"businessType",t)},expression:"form.businessType"}},e._l(e.businessTypes,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.code}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"配置名称",prop:"partnerCode"}},[a("a-input",{attrs:{"max-length":50},model:{value:e.form.partnerCode,callback:function(t){e.$set(e.form,"partnerCode",t)},expression:"form.partnerCode"}})],1)],1)],1),a("a-row",{attrs:{gutter:[0,0]}},[a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"收付类型",prop:"rpType"}},[a("a-select",{model:{value:e.form.rpType,callback:function(t){e.$set(e.form,"rpType",t)},expression:"form.rpType"}},e._l(e.ARAPs,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[a("a-input",{attrs:{"max-length":200},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),a("a-col",{attrs:{span:6}},[a("a-form-model-item",{attrs:{label:"状态",prop:"status"}},[a("a-select",{model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}},e._l(e.quotationTypes,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)],1)],1)],1)],1),a("a-tabs",{attrs:{"default-active-key":1}},[a("a-tab-pane",{key:1,attrs:{tab:"基础字段匹配"}},[a("vxe-table",{ref:"xTable",attrs:{"keep-source":"",data:e.busColsMappingList,loading:e.loading,"print-config":{},"show-overflow":"",resizable:"",border:"","highlight-hover-row":"",height:e.minHeight,"edit-config":"0"==e.ID?{trigger:"click",mode:"row",showStatus:!0}:{},"edit-rules":"0"==e.ID?e.validRules:{}}},[a("vxe-column",{attrs:{type:"checkbox",width:"50"},scopedSlots:e._u([{key:"header",fn:function(t){var n=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleAllCheckboxRow()}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:n?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}},{key:"checkbox",fn:function(t){var n=t.row,r=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleCheckboxRow(n)}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:r?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}}])}),a("vxe-column",{attrs:{field:"chargeColumn",title:"计费字段","edit-render":{name:"$input",defaultValue:"",props:{disabled:!0}}}}),a("vxe-column",{attrs:{field:"chargeColumnDesc",title:"计费字段描述","edit-render":{name:"$input",defaultValue:"",props:{disabled:!0}}}}),a("vxe-column",{attrs:{field:"businessColumn",title:"业务字段","edit-render":{}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("a-select",{staticStyle:{width:"100%"},on:{change:function(t){return e.change1(t,n)}},model:{value:n.businessColumn,callback:function(t){e.$set(n,"businessColumn",t)},expression:"row.businessColumn"}},e._l(e.columnsByBusAsync,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.dbColumn}},[e._v(" "+e._s(t.dbColumn)+" ")])})),1)]}}])}),a("vxe-column",{attrs:{field:"businessColumnDesc",title:"业务字段描述"}}),a("vxe-column",{attrs:{field:"colMappingType",title:"匹配类型","edit-render":{}},scopedSlots:e._u([{key:"edit",fn:function(t){var n=t.row;return[a("a-select",{staticStyle:{width:"100%"},model:{value:n.colMappingType,callback:function(t){e.$set(n,"colMappingType",t)},expression:"row.colMappingType"}},e._l(e.mippingTypes,(function(t,n){return a("a-select-option",{key:n,attrs:{value:t.value}},[e._v(" "+e._s(t.name)+" ")])})),1)]}},{key:"default",fn:function(t){var n=t.row;return[e._l(e.mippingTypes,(function(t){return[n.colMappingType==t.value?a("span",{key:t.id},[e._v(e._s(t.name))]):e._e()]}))]}}])}),a("vxe-column",{attrs:{field:"remark",title:"备注","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{field:"status",title:"状态","edit-render":{name:"$select",defaultValue:1,options:e.statusList,props:{clearable:!1}}},scopedSlots:e._u([{key:"default",fn:function(t){return t=t.row,[0==t.status?a("a-tag",{attrs:{color:"#f5222d"}},[e._v("禁用")]):e._e(),1==t.status?a("a-tag",{attrs:{color:"#1890ff"}},[e._v("启用")]):e._e()]}}])}),a("vxe-column",{attrs:{width:"60",fixed:"right",title:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a-space",[n.id||"0"!=e.ID?e._e():a("a-popconfirm",{attrs:{title:"删除"},on:{confirm:function(t){return e.$refs.xTable.remove(n)}}},[a("a-tooltip",{attrs:{placement:"top",title:"删除"}},[a("a-button",{attrs:{type:"danger",size:"small",icon:"delete"}})],1)],1)],1)]}}])})],1)],1),a("a-tab-pane",{key:2,attrs:{tab:"报价表明细",disabled:"0"==e.ID}},[a("QuotationLine",{attrs:{ID:e.ID.toString(),dynamicFields:e.dynamicFields}})],1)],1)],1)}),[],!1,null,"32b88f65",null).exports;t.default=_}}]);