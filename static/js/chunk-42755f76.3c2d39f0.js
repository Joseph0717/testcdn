(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-42755f76"],{4012:function(e,t,n){"use strict";n.r(t),n("d9e2"),n("b0c0"),n("a4d3"),n("e01a");var a=n("1da1"),i=(n("96cf"),n("7424")),r=n("b775");function o(e,t){return l.apply(this,arguments)}function l(){return(l=Object(a.a)(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r.e)(i.TENANTGETPAGE,r.a.POST,{currentPage:t,pageSize:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function s(e){return c.apply(this,arguments)}function c(){return(c=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r.e)(i.TENANTGET,r.a.GET,{id:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return u.apply(this,arguments)}function u(){return(u=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r.e)(i.TENANTUPDATE,r.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return p.apply(this,arguments)}function p(){return(p=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r.e)(i.TENANTADD,r.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return b.apply(this,arguments)}function b(){return(b=Object(a.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(r.e)(i.TENANTSOFTDELETE,r.a.DELETE,{id:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h={name:"Tenant",data:function(){return{tenantList:[],columns:[{title:"#",dataIndex:"id",scopedSlots:{customRender:"id"}},{title:"租户名",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"编码",dataIndex:"code",scopedSlots:{customRender:"code"}},{title:"数据库",dataIndex:"dbTypeName",scopedSlots:{customRender:"dbTypeName"}},{title:"空闲时间(分)",dataIndex:"idleTime",scopedSlots:{customRender:"idleTime"}},{title:"创建时间",dataIndex:"createdTime",scopedSlots:{customRender:"createdTime"}},{title:"状态",dataIndex:"enabled",scopedSlots:{customRender:"enabled"}},{title:"操作",scopedSlots:{customRender:"operation"}}],loading:!1,dbTypeList:[{label:"MySql",value:0},{label:"SqlServer",value:1},{label:"PostgreSQL",value:2},{label:"Oracle",value:3},{label:"Sqlite",value:4},{label:"OdbcOracle",value:5},{label:"OdbcSqlServer",value:6},{label:"OdbcMySql",value:7},{label:"OdbcPostgreSQL",value:8},{label:"Odbc",value:9},{label:"OdbcDameng",value:10},{label:"MsAccess",value:11},{label:"Dameng",value:12},{label:"OdbcKingbaseES",value:13},{label:"ShenTong",value:14},{label:"KingbaseES",value:15},{label:"Firebird",value:16}],title:"",visible:!1,confirmLoading:!1,spinning:!1,form:{},type:"",rules:{name:[{validator:function(e,t,n){""===t?n(new Error("租户名不能为空")):n()},trigger:"change",required:!0}],code:[{validator:function(e,t,n){""===t?n(new Error("编码不能为空")):n()},trigger:"change",required:!0}]}}},created:function(){this.getTenantData()},methods:{getTenantData:function(){var e=this;this.loading=!0,o().then((function(t){1===t.data.code&&(e.tenantList=t.data.data.list,e.loading=!1)}))},showModalEdit:function(e){var t=this;this.title="编辑租户",this.form={},this.visible=!0,this.spinning=!0,this.type="edit",s(e.id).then((function(e){1===e.data.code&&(e=e.data.data,t.form={code:e.code,name:e.name,dbType:0,connectionString:e.connectionString,idleTime:e.idleTime,enabled:e.enabled,description:e.description,id:e.id,version:0},t.spinning=!1)}))},showModalAdd:function(){this.title="新增租户",this.form={},this.visible=!0,this.type="add",this.form={code:"",name:"",dbType:0,connectionString:"",idleTime:10,enabled:!0,description:""}},handelOk:function(){var e=this;this.confirmLoading=!0,this.$refs.form.validate((function(t){if(!t)return e.confirmLoading=!1;"edit"==e.type?d(e.form).then((function(t){1===t.data.code&&(e.confirmLoading=!1,e.visible=!1,e.getTenantData())})):m(e.form).then((function(t){1===t.data.code&&(e.confirmLoading=!1,e.visible=!1,e.getTenantData())}))}))},handelCancel:function(){this.visible=!1},confirmDelete:function(e){var t=this;f(e.id).then((function(e){1===e.data.code&&t.getTenantData()}))},handleDbChange:function(e){this.form.dbType=e},handleNumberChange:function(e){this.form.idleTime=e}}};n("cc7e"),n=n("2877"),n=Object(n.a)(h,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"Tenant"},[n("a-page-header",[n("template",{slot:"extra"},[n("a-space",[n("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:tenant:add",expression:"`api:admin:tenant:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:e.showModalAdd}},[e._v("新增")])],1)],1)],2),n("a-table",{attrs:{columns:e.columns,"data-source":e.tenantList,loading:e.loading,rowKey:"id",bordered:"",size:"small"},scopedSlots:e._u([{key:"enabled",fn:function(t){return n("span",{},[n("a-tag",{attrs:{color:t?"#108ee9":"#f50"}},[e._v(" "+e._s(t?"正常":"禁用")+" ")])],1)}},{key:"operation",fn:function(t){return n("span",{},[n("a-space",[n("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:tenant:update",expression:"`api:admin:tenant:update`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"edit"},on:{click:function(n){return e.showModalEdit(t)}}},[e._v("编辑")]),n("a-popconfirm",{attrs:{title:"Sure to delete?","cancel-text":"取消"},on:{confirm:function(n){return e.confirmDelete(t)}}},[n("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:tenant:softdelete",expression:"`api:admin:tenant:softdelete`",arg:"permission"}],attrs:{type:"danger",size:"small",icon:"delete"}},[e._v("删除")])],1)],1)],1)}}])}),n("a-modal",{attrs:{title:e.title,centered:"",visible:e.visible,"confirm-loading":e.confirmLoading,maskClosable:!1},on:{ok:e.handelOk,cancel:e.handelCancel}},[n("template",{slot:"closeIcon"},[n("a-button",{attrs:{type:"danger",size:"small",shape:"circle",icon:"close-circle"}})],1),n("a-spin",{attrs:{spinning:e.spinning}},[n("a-form-model",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-col":{span:4},"wrapper-col":{span:20}}},[n("a-form-model-item",{attrs:{label:"租户名",prop:"name"}},[n("a-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("a-form-model-item",{attrs:{label:"编码",prop:"code"}},[n("a-input",{model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}})],1),n("a-form-model-item",{attrs:{label:"数据库"}},[n("a-select",{attrs:{options:e.dbTypeList,value:e.form.dbType},on:{change:e.handleDbChange}})],1),n("a-form-model-item",{attrs:{label:"空闲时间"}},[n("a-space",[n("a-input-number",{attrs:{min:0,value:e.form.idleTime},on:{change:e.handleNumberChange}}),n("span",[e._v("(分)")])],1)],1),n("a-form-model-item",{attrs:{label:"状态"}},[n("a-switch",{attrs:{checked:e.form.enabled,size:"small"},on:{click:function(t){e.form.enabled=!e.form.enabled}}})],1),n("a-form-model-item",{attrs:{label:"连接字符串"}},[n("a-input",{model:{value:e.form.connectionString,callback:function(t){e.$set(e.form,"connectionString",t)},expression:"form.connectionString"}})],1),n("a-form-model-item",{attrs:{label:"说明"}},[n("a-input",{model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1)],1)],1)],2)],1)}),[],!1,null,null,null);t.default=n.exports},"868a":function(e,t,n){},cc7e:function(e,t,n){"use strict";n("868a")}}]);