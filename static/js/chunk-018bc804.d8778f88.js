(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-018bc804"],{2430:function(e,t,a){"use strict";a("68b2")},"2fc4":function(e,t,a){"use strict";a("4de4"),a("d3b7");var n={name:"MySearch",props:{fields:{type:Array,default:function(){return[]}}},data:function(){return{filter:{field:"",value:"",operator:"Contains"}}},created:function(){this.filter.field=this.fields[0].value},methods:{change:function(e){this.filter.field=e},onSearch:function(e){this.filter.value=e,e=this.filter,this.$emit("click",e)}}};a=a("2877"),a=Object(a.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-input-search",{attrs:{allowClear:""},on:{search:e.onSearch}},[a("a-select",{staticStyle:{"min-width":"100px"},attrs:{slot:"addonBefore"},on:{change:e.change},slot:"addonBefore",model:{value:e.filter.field,callback:function(t){e.$set(e.filter,"field",t)},expression:"filter.field"}},[e._l(e.fields,(function(t){return["string"==t.type?a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")]):e._e()]}))],2),a("a-button",{attrs:{slot:"enterButton",icon:"search"},slot:"enterButton"})],1)],1)}),[],!1,null,null,null);t.a=a.exports},"5eec":function(e,t,a){},"68b2":function(e,t,a){},"6c27":function(e,t,a){"use strict";a.d(t,"e",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return u})),a.d(t,"g",(function(){return f})),a.d(t,"b",(function(){return m})),a.d(t,"f",(function(){return g})),a.d(t,"d",(function(){return y}));var n=a("1da1"),r=(a("96cf"),a("7424")),i=a("b775");function s(e,t,a){return o.apply(this,arguments)}function o(){return(o=Object(n.a)(regeneratorRuntime.mark((function e(t,a,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUERYPERMISSIONSGETPAGE,i.a.POST,{currentPage:t,pageSize:a,dynamicFilter:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function l(e){return c.apply(this,arguments)}function c(){return(c=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUERYPERMISSIONSADD,i.a.POST,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return(d=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUERYPERMISSIONSGET,i.a.GET,{id:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return p.apply(this,arguments)}function p(){return(p=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUERYPERMISSIONSUPDATE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUERYPERMISSIONSBATCHSOFTDELETE,i.a.PUT,t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return b.apply(this,arguments)}function b(){return(b=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUERYPERMISSIONSCACHELISTASYNC,i.a.GET));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return v.apply(this,arguments)}function v(){return(v=Object(n.a)(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(i.e)(r.QUERYPERMISSIONSGETAREAPERMISSIONCOLLISTASYNC,i.a.GET,{aptype:t}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},8572:function(e,t,a){"use strict";var n=a("5530"),r=(a("7db0"),a("d3b7"),a("c740"),a("ac1f"),a("5319"),a("a434"),a("2ef0")),i=a.n(r);r={name:"MySearchFilter",props:{fields:{type:Array,default:function(){return[]}}},data:function(){var e={equal:{label:"等于",value:"Equal"},notEqual:{label:"不等于",value:"NotEqual"},contains:{label:"包含",value:"Contains"},notContains:{label:"不包含",value:"NotContains"},startsWith:{label:"开始以",value:"StartsWith"},notStartsWith:{label:"开始不是以",value:"NotStartsWith"},endsWith:{label:"结束以",value:"EndsWith"},notEndsWith:{label:"结束不是以",value:"NotEndsWith"},lessThan:{label:"小于",value:"LessThan"},lessThanOrEqual:{label:"小于等于",value:"LessThanOrEqual"},greaterThan:{label:"大于",value:"GreaterThan"},greaterThanOrEqual:{label:"大于等于",value:"GreaterThanOrEqual"},dateRange:{label:"时间段",value:"dateRange"},any:{label:"在列表",value:"Any"},notAny:{label:"不在列表",value:"NotAny"}},t={field:"",label:""};return{key:1,dataTree:{root:!0,logic:"And",filters:[]},defaultProps:{label:"",children:["filters"]},operatorGroups:{string:[e.equal,e.notEqual,e.contains,e.notContains,e.startsWith,e.notStartsWith,e.endsWith,e.notEndsWith],date:[e.equal,e.notEqual,e.lessThan,e.lessThanOrEqual,e.greaterThan,e.greaterThanOrEqual,e.dateRange],number:[e.equal,e.notEqual,e.lessThan,e.lessThanOrEqual,e.greaterThan,e.greaterThanOrEqual],bool:[e.equal,e.notEqual]},firstField:t=this.fields&&0<this.fields.length?this.fields.find((function(e){return!0===e.default}))||this.fields[0]:t,datePickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}}}},computed:{},watch:{},mounted:function(){},methods:{getOperators:function(e){return e=this.operatorGroups[e||"string"],e&&0<e.length?e:e.string},onChangeField:function(e,t){var a=this.fields.find((function(t){return t.value===e})),r=(t.value="",t.label=a.label,t.type=a.type||"",this.getOperators(t.type)),i="";i=(i=a.operator?0<=r.findIndex((function(e){return e.value===a.operator}))?a.operator:"":i)||r[0].value,t.operator=i,t.config=Object(n.a)({},a.config),"date"===t.type&&(r="date","dateRange"===t.operator&&(r+="range"),t.config.type=t.config.type||r,0<=t.config.type.indexOf("range")&&(t.operator="dateRange"),t.config.format=t.config.format||"yyyy-MM-dd",t.config.valueFormat=t.config.valueFormat||"yyyy-MM-dd",t.config.defaultTime=t.config.defaultTime||["00:00:00","00:00:00"])},onChangeOperator:function(e,t){"date"===t.type&&(this.key++,"dateRange"===e?(t.value="",t.config.type=t.config.type+"range"):0<=t.config.type.indexOf("range")&&(t.value="",t.config.type=t.config.type.replace(/range$/,"")))},onAddGroup:function(e){e.filters||this.$set(e,"filters",[]),e.filters.push({logic:"And"})},onAddCondition:function(e){var t=this.getOperators(e.type)[0],a=(t={field:this.firstField.value,label:this.firstField.label,operator:t.value,value:""},e.filters||this.$set(e,"filters",[]),e.filters.findIndex((function(e){return e.logic&&!e.field})));0<=a?e.filters.splice(a,0,t):e.filters.push(t)},onDelete:function(e,t){e=e.parent,e=e.data.filters||e.data;var a=e.findIndex((function(e){return e===t}));e.splice(a,1)},reset:function(){this.dataTree.filters=[]},getDynamicFilter:function(){return i.a.cloneDeep(this.dataTree)},setDynamicFilter:function(e){this.$set(this.dataTree,"root",e.root),this.$set(this.dataTree,"logic",e.logic),this.$set(this.dataTree,"filters",e.filters)},type:function(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]},deepClone:function(e){var t,a,n,r=this.type(e);if("array"===r)t=[];else{if("object"!==r)return e;t={}}if("array"===r){for(a=0,n=e.length;a<n;a++)t.push(this.deepClone(e[a]));return t}if("object"===r){for(a in e)"config"!==a&&"type"!==a&&"label"!==a&&(t[a]=this.deepClone(e[a]));return t}}}},a("2430"),a=a("2877"),a=Object(a.a)(r,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tree",{staticClass:"my-search-filter",attrs:{data:[e.dataTree],props:e.defaultProps,"expand-on-click-node":!1,"default-expand-all":!0,indent:16},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,r=t.data;return[r.logic&&!r.field?[a("span",[a("a-space",[a("a-radio-group",{model:{value:r.logic,callback:function(t){e.$set(r,"logic",t)},expression:"data.logic"}},[a("a-radio",{attrs:{value:"And"}},[e._v("并且")]),a("a-radio",{attrs:{value:"Or"}},[e._v("或者")])],1),a("a-button",{attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:function(t){return e.onAddGroup(r)}}},[e._v("分组")]),a("a-button",{attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:function(t){return e.onAddCondition(r)}}},[e._v("条件")]),r.root?e._e():a("a-button",{attrs:{type:"danger",size:"small",shape:"circle",icon:"minus-circle"},on:{click:function(t){return e.onDelete(n,r)}}})],1)],1)]:[a("span",[a("el-select",{staticStyle:{"min-width":"100px"},attrs:{size:"small",filterable:""},on:{change:function(t){return e.onChangeField(t,r)}},model:{value:r.field,callback:function(t){e.$set(r,"field",t)},expression:"data.field"}},e._l(e.fields,(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),a("el-select",{staticStyle:{"min-width":"100px","margin-left":"5px"},attrs:{size:"small"},on:{change:function(t){return e.onChangeOperator(t,r)}},model:{value:r.operator,callback:function(t){e.$set(r,"operator",t)},expression:"data.operator"}},e._l(e.getOperators(r.type),(function(e,t){return a("el-option",{key:t,attrs:{label:e.label,value:e.value}})})),1),"date"===r.type?[0<=r.config.type.indexOf("range")?a("el-date-picker",{key:e.key,staticStyle:{"margin-left":"5px"},attrs:{type:r.config.type,"unlink-panels":"","start-placeholder":"开始时间","end-placeholder":"结束时间","default-time":r.config.defaultTime,format:r.config.format,"value-format":r.config.valueFormat,"picker-options":e.datePickerOptions,size:"mini"},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"data.value"}}):a("el-date-picker",{key:e.key,staticStyle:{"margin-left":"5px"},attrs:{type:r.config.type,format:r.config.format,"value-format":r.config.valueFormat,"picker-options":e.datePickerOptions,size:"mini"},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"data.value"}})]:"number"===r.type?a("a-input-number",{staticStyle:{width:"120px","margin-left":"5px"},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"data.value"}}):"bool"===r.type?a("a-switch",{staticStyle:{"margin-left":"5px"},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"data.value"}}):a("a-input",{staticStyle:{width:"160px","margin-left":"5px"},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"data.value"}}),a("a-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"danger",size:"small",icon:"delete",shape:"circle"},on:{click:function(t){return e.onDelete(n,r)}}})],2)]]}}])})}),[],!1,null,"57ee8dc3",null);t.a=a.exports},"8a24":function(e,t,a){"use strict";a("5eec")},f156:function(e,t,a){"use strict";a.r(t),a("4de4"),a("d3b7"),a("d81d"),a("e9c4");var n=a("6c27"),r=a("a701"),i=a("2fc4"),s=a("8572");i={name:"QueryPermissions",i18n:a("9225"),components:{MySearch:i.a,MySearchFilter:s.a},computed:{fields:function(){return[{value:"rateSource",label:"汇率来源",type:"string"},{value:"rateDate",label:"汇率日期",type:"string"}]}},data:function(){return{minHeight:window.innerHeight-219,queryPermissionsList:[],areaPermissions:[],loading:!1,pagination:{currentPage:1,pageSize:100,totalResult:0},dynamicFilter:{},form:{},rules:{areaPermission:[{required:!0,message:"请选择权限区域",trigger:"change"}],permissionName:[{required:!0,message:"请输入权限名称",trigger:"change"}]},title:"",type:"",visible:!1,confirmLoading:!1,spinning:!1,disabled:!1,queryFields:[]}},created:function(){this.getQueryPermissionsList(),this.getDictionary()},methods:{getDictionary:function(){var e=this;Object(r.d)(["AreaPermission"]).then((function(t){1===t.data.code&&(t=t.data.data,e.areaPermissions=t.filter((function(e){return"AreaPermission"===e.code}))[0].data)}))},getQueryPermissionsList:function(){var e=this;this.loading=!0,Object(n.e)(this.pagination.currentPage,this.pagination.pageSize,this.dynamicFilter).then((function(t){1===t.data.code&&(e.queryPermissionsList=t.data.data.list,e.pagination.totalResult=t.data.data.total,e.loading=!1)}))},handlePageChange:function(e){var t=e.currentPage;e=e.pageSize;this.pagination.currentPage=t,this.pagination.pageSize=e,this.getQueryPermissionsList()},onSearch:function(e){this.dynamicFilter=e,this.pagination.currentPage=1,this.getQueryPermissionsList()},change:function(e){var t=this;this.queryFields=[],this.form.jsonText="",this.$refs.searchFilter.setDynamicFilter({root:!0,logic:"And",filters:[]}),Object(n.d)(e).then((function(e){1===e.data.code&&e.data.data.map((function(e){t.queryFields.push({value:e,label:e,type:"string"})}))}))},insert:function(){this.title="新增",this.type="add",this.visible=!0,this.queryFields=[],this.form={status:1,areaPermission:"",permissionName:"",jsonText:"",remark:""}},edit:function(e){var t=this;this.title="编辑",this.type="edit",this.visible=!0,this.disabled=!0,this.spinning=!0,this.queryFields=[],Object(n.c)(e.id).then((function(e){1===e.data.code&&(t.form=e.data.data,t.$refs.searchFilter.setDynamicFilter(JSON.parse(t.form.jsonText)),Object(n.d)(t.form.areaPermission).then((function(e){1===e.data.code&&e.data.data.map((function(e){t.queryFields.push({value:e,label:e,type:"string"})}))})),t.disabled=!1,t.spinning=!1)}))},handleOk:function(){var e=this;this.$refs.form.validate((function(t){t&&(e.confirmLoading=!0,e.form.jsonText=JSON.stringify(e.$refs.searchFilter.getDynamicFilter()),"add"==e.type?Object(n.a)(e.form).then((function(t){1===t.data.code?(e.confirmLoading=!1,e.visible=!1,e.$message.success("保存成功!"),e.getQueryPermissionsList()):(e.confirmLoading=!1,e.$message.error(t.data.msg))})).catch((function(t){e.confirmLoading=!1,e.$message.error("系统内部错误!")})):Object(n.g)(e.form).then((function(t){1===t.data.code?(e.confirmLoading=!1,e.visible=!1,e.$message.success("保存成功!"),e.getQueryPermissionsList()):(e.confirmLoading=!1,e.$message.error(t.data.msg))})).catch((function(t){e.confirmLoading=!1,e.$message.error("系统内部错误!")})))}))},batchDelete:function(){var e=this,t=this.$refs.xTable.getCheckboxRecords();if(0==t.length)return!1;t=t.map((function(e){return e.id})),Object(n.b)(t).then((function(t){1===t.data.code&&e.getQueryPermissionsList()}))}}},a("8a24"),s=a("2877"),a=Object(s.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"QueryPermissions"},[a("vxe-toolbar",{attrs:{custom:"",print:""},scopedSlots:e._u([{key:"tools",fn:function(){return[a("a-space",[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:querypermissions:add",expression:"`api:admin:querypermissions:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:e.insert}},[e._v(e._s(e.$t("37")))]),!e.loading&&0<e.$refs.xTable.getCheckboxRecords().length?a("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:e.batchDelete}},[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:querypermissions:batchsoftdelete",expression:"`api:admin:querypermissions:batchsoftdelete`",arg:"permission"}],attrs:{type:"danger",size:"small",icon:"delete"}},[e._v("删除")])],1):e._e(),a("my-search",{attrs:{fields:e.fields},on:{click:e.onSearch}})],1)]},proxy:!0}])}),a("vxe-table",{ref:"xTable",attrs:{"keep-source":"",data:e.queryPermissionsList,loading:e.loading,"print-config":{},"show-overflow":"",resizable:"",border:"","highlight-hover-row":"",height:e.minHeight}},[a("vxe-column",{attrs:{type:"checkbox",width:"50"},scopedSlots:e._u([{key:"header",fn:function(t){var n=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleAllCheckboxRow()}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:n?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}},{key:"checkbox",fn:function(t){var n=t.row,r=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleCheckboxRow(n)}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:r?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}}])}),a("vxe-column",{attrs:{field:"areaPermission",title:"权限区域"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[e._l(e.areaPermissions,(function(t){return[t.value==n.areaPermission?a("span",{key:t.value},[e._v(e._s(t.name))]):e._e()]}))]}}])}),a("vxe-column",{attrs:{field:"permissionName",title:"权限名称"}}),a("vxe-column",{attrs:{field:"remark",title:"备注"}}),a("vxe-column",{attrs:{field:"status",title:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return t=t.row,[0==t.status?a("a-tag",{attrs:{color:"#f5222d"}},[e._v("禁用")]):e._e(),1==t.status?a("a-tag",{attrs:{color:"#1890ff"}},[e._v("启用")]):e._e()]}}])}),a("vxe-column",{attrs:{width:"60",fixed:"right",title:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a-space",[n.id?a("a-tooltip",{attrs:{placement:"top",title:"编辑"}},[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:querypermissions:update",expression:"`api:admin:querypermissions:update`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"edit"},on:{click:function(t){return e.edit(n)}}})],1):e._e()],1)]}}])})],1),a("vxe-pager",{attrs:{"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize,total:e.pagination.totalResult,"page-sizes":[20,50,100,200],layouts:["PrevPage","JumpNumber","NextPage","Sizes","Total"]},on:{"page-change":e.handlePageChange}}),a("a-modal",{attrs:{visible:e.visible,title:e.title,"confirm-loading":e.confirmLoading,maskClosable:!1,destroyOnClose:!0,"ok-button-props":{props:{disabled:e.disabled}},centered:""},on:{cancel:function(t){e.visible=!1},ok:e.handleOk}},[a("template",{slot:"closeIcon"},[a("a-button",{attrs:{type:"danger",size:"small",shape:"circle",icon:"close-circle"}})],1),a("a-spin",{attrs:{spinning:e.spinning}},[a("a-form-model",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("a-form-model-item",{attrs:{label:"权限区域",prop:"areaPermission"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{size:"small",filterable:"",placeholder:""},on:{change:e.change},model:{value:e.form.areaPermission,callback:function(t){e.$set(e.form,"areaPermission",t)},expression:"form.areaPermission"}},e._l(e.areaPermissions,(function(e,t){return a("el-option",{key:t,attrs:{label:e.name,value:e.value}})})),1)],1),a("a-form-model-item",{attrs:{label:"权限名称",prop:"permissionName"}},[a("a-input",{attrs:{"max-length":20},model:{value:e.form.permissionName,callback:function(t){e.$set(e.form,"permissionName",t)},expression:"form.permissionName"}})],1),a("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[a("a-input",{attrs:{"max-length":200},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1),a("a-form-model-item",{attrs:{label:"状态",prop:"status"}},[a("a-switch",{attrs:{size:"small",checked:0!==e.form.status},on:{click:function(t){e.form.status=0===e.form.status?1:0}}})],1)],1),a("my-search-filter",{ref:"searchFilter",attrs:{fields:e.queryFields}})],1)],2)],1)}),[],!1,null,"63d522cb",null).exports;t.default=a}}]);