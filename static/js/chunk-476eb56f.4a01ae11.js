(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-476eb56f"],{1554:function(e,t,a){"use strict";a.r(t);var n=a("1da1"),r=(a("d81d"),a("96cf"),a("309a")),i=a("2fc4");i={name:"Organization",i18n:a("9225"),components:{MySearch:i.a},computed:{fields:function(){return[{value:"orgCode",label:"组织代码",type:"string"},{value:"orgName",label:"组织名称",type:"string"},{value:"shortName",label:"组织简称",type:"string"},{value:"enName",label:"组织英文名称",type:"string"}]}},data:function(){return{minHeight:window.innerHeight-219,organizationList:[],loading:!1,pagination:{currentPage:1,pageSize:100,totalResult:0},dynamicFilter:{},statusList:[{label:"禁用",value:0},{label:"启用",value:1}],validRules:{orgCode:[{required:!0,message:"请输入组织代码"}],orgName:[{required:!0,message:"请输入组织名称"}]}}},created:function(){this.getOrganizationList()},methods:{getOrganizationList:function(){var e=this;this.loading=!0,Object(r.c)(this.pagination.currentPage,this.pagination.pageSize,this.dynamicFilter).then((function(t){1===t.data.code&&(e.organizationList=t.data.data.list,e.pagination.totalResult=t.data.data.total,e.loading=!1)}))},handlePageChange:function(e){var t=e.currentPage;e=e.pageSize;this.pagination.currentPage=t,this.pagination.pageSize=e,this.getOrganizationList()},onSearch:function(e){this.dynamicFilter=e,this.pagination.currentPage=1,this.getOrganizationList()},insert:function(){this.$refs.xTable.insert({parentID:0})},insertRow:function(e){var t=this;return Object(n.a)(regeneratorRuntime.mark((function a(){var n,r,i;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=t.$refs.xTable,r={parentID:e.id},a.next=4,n.insert(r);case 4:return r=a.sent,i=r.row,a.next=8,n.setTreeExpand(e,!0);case 8:return a.next=10,n.setActiveRow(i);case 10:case"end":return a.stop()}}),a)})))()},save:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var a,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.$refs.xTable,i=a.getRecordset(),n=i.insertRecords,i.removeRecords,i=i.updateRecords,0==n.length&&0==i)return t.abrupt("return",!1);t.next=4;break;case 4:return t.next=6,a.validate(!0).catch((function(e){return e}));case 6:if(t.sent)return t.abrupt("return",!1);t.next=9;break;case 9:e.loading=!0,0<n.length&&(n.reverse(),n.map((function(t){t={status:t.status,parentID:t.parentID,orgCode:t.orgCode,orgName:t.orgName,shortName:t.shortName,enName:t.enName,areaCode:t.areaCode,orgAddress:t.orgAddress,postCode:t.postCode,orgTel:t.orgTel,orgFax:t.orgFax,orgContact:t.orgContact,orgEmail:t.orgEmail,remark:t.remark},Object(r.a)(t).then((function(t){1===t.data.code?(e.$message.success("保存成功!"),e.getOrganizationList()):(e.loading=!1,e.$message.error(t.data.msg))}))}))),0<i.length&&i.map((function(t){t={status:t.status,parentID:t.parentID,orgCode:t.orgCode,orgName:t.orgName,shortName:t.shortName,enName:t.enName,areaCode:t.areaCode,orgAddress:t.orgAddress,postCode:t.postCode,orgTel:t.orgTel,orgFax:t.orgFax,orgContact:t.orgContact,orgEmail:t.orgEmail,remark:t.remark,id:t.id,version:1},Object(r.d)(t).then((function(t){1===t.data.code?(e.$message.success("保存成功!"),e.getOrganizationList()):(e.loading=!1,e.$message.error(t.data.msg))}))}));case 12:case"end":return t.stop()}}),t)})))()},batchDelete:function(){var e=this,t=this.$refs.xTable.getCheckboxRecords();if(0==t.length)return!1;t=t.map((function(e){return e.id})),Object(r.b)(t).then((function(t){1===t.data.code&&e.getOrganizationList()}))}}},a("eb43"),a=a("2877"),a=Object(a.a)(i,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Organization"},[a("vxe-toolbar",{attrs:{custom:"",print:""},scopedSlots:e._u([{key:"tools",fn:function(){return[a("a-space",[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:organization:add",expression:"`api:admin:organization:add`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:e.insert}},[e._v(e._s(e.$t("37")))]),a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:organization:update",expression:"`api:admin:organization:update`",arg:"permission"}],attrs:{type:"primary",size:"small",icon:"save"},on:{click:e.save}},[e._v("保存")]),!e.loading&&0<e.$refs.xTable.getCheckboxRecords().length?a("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:e.batchDelete}},[a("a-button",{directives:[{name:"auth",rawName:"v-auth:permission",value:"api:admin:organization:batchsoftdelete",expression:"`api:admin:organization:batchsoftdelete`",arg:"permission"}],attrs:{type:"danger",size:"small",icon:"delete"}},[e._v("删除")])],1):e._e(),a("my-search",{attrs:{fields:e.fields},on:{click:e.onSearch}})],1)]},proxy:!0}])}),a("vxe-table",{ref:"xTable",attrs:{"keep-source":"",data:e.organizationList,loading:e.loading,"print-config":{},"show-overflow":"",resizable:"",border:"","highlight-hover-row":"",height:e.minHeight,"edit-config":{trigger:"click",mode:"row",showStatus:!0},"edit-rules":e.validRules,"tree-config":{transform:!0,rowField:"id",parentField:"parentID"},"checkbox-config":{checkStrictly:!0}}},[a("vxe-column",{attrs:{type:"checkbox",width:"50",fixed:"left"},scopedSlots:e._u([{key:"header",fn:function(t){var n=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleAllCheckboxRow()}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:n?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}},{key:"checkbox",fn:function(t){var n=t.row,r=t.checked;t=t.indeterminate;return[a("span",{staticClass:"custom-checkbox",on:{click:function(t){return t.stopPropagation(),e.$refs.xTable.toggleCheckboxRow(n)}}},[a("span",t?[a("a-checkbox",{attrs:{indeterminate:!0}})]:r?[a("a-checkbox",{attrs:{checked:!0}})]:[a("a-checkbox")],1)])]}}])}),a("vxe-column",{attrs:{width:"150","tree-node":"",field:"orgCode",title:"组织代码","edit-render":{name:"$input",defaultValue:"",props:{maxlength:20}}}}),a("vxe-column",{attrs:{width:"150",field:"orgName",title:"组织名称","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{width:"150",field:"shortName",title:"组织简称","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{width:"150",field:"enName",title:"组织英文名称","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{width:"150",field:"areaCode",title:"区域（城市）","edit-render":{name:"$input",defaultValue:"",props:{maxlength:20}}}}),a("vxe-column",{attrs:{width:"150",field:"orgAddress",title:"组织地址","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{width:"150",field:"postCode",title:"邮政编码","edit-render":{name:"$input",defaultValue:"",props:{maxlength:50}}}}),a("vxe-column",{attrs:{width:"150",field:"orgTel",title:"组织电话","edit-render":{name:"$input",defaultValue:"",props:{maxlength:100}}}}),a("vxe-column",{attrs:{width:"150",field:"orgFax",title:"组织传真","edit-render":{name:"$input",defaultValue:"",props:{maxlength:100}}}}),a("vxe-column",{attrs:{width:"150",field:"orgContact",title:"组织联系人","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{width:"150",field:"orgEmail",title:"组织邮箱","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{width:"150",field:"remark",title:"备注","edit-render":{name:"$input",defaultValue:"",props:{maxlength:200}}}}),a("vxe-column",{attrs:{width:"150",field:"status",title:"状态","edit-render":{name:"$select",defaultValue:1,options:e.statusList,props:{clearable:!1}}},scopedSlots:e._u([{key:"default",fn:function(t){return t=t.row,[0==t.status?a("a-tag",{attrs:{color:"#f5222d"}},[e._v("禁用")]):e._e(),1==t.status?a("a-tag",{attrs:{color:"#1890ff"}},[e._v("启用")]):e._e()]}}])}),a("vxe-column",{attrs:{width:"100",fixed:"right",title:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[n.id?a("a-button",{attrs:{type:"primary",size:"small",icon:"plus-circle"},on:{click:function(t){return e.insertRow(n)}}}):e._e(),n.id?e._e():a("a-popconfirm",{attrs:{title:e.$t("47")},on:{confirm:function(t){return e.$refs.xTable.remove(n)}}},[a("a-tooltip",{attrs:{placement:"top",title:"删除"}},[a("a-button",{attrs:{type:"danger",size:"small",icon:"delete"}})],1)],1)]}}])})],1),a("vxe-pager",{attrs:{"current-page":e.pagination.currentPage,"page-size":e.pagination.pageSize,total:e.pagination.totalResult,"page-sizes":[20,50,100,200],layouts:["PrevPage","JumpNumber","NextPage","Sizes","Total"]},on:{"page-change":e.handlePageChange}})],1)}),[],!1,null,"35a6e4f2",null).exports;t.default=a},"231c":function(e,t,a){},"2fc4":function(e,t,a){"use strict";a("4de4"),a("d3b7");var n={name:"MySearch",props:{fields:{type:Array,default:function(){return[]}}},data:function(){return{filter:{field:"",value:"",operator:"Contains"}}},created:function(){this.filter.field=this.fields[0].value},methods:{change:function(e){this.filter.field=e},onSearch:function(e){this.filter.value=e,e=this.filter,this.$emit("click",e)}}};a=a("2877"),a=Object(a.a)(n,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-input-search",{attrs:{allowClear:""},on:{search:e.onSearch}},[a("a-select",{staticStyle:{"min-width":"100px"},attrs:{slot:"addonBefore"},on:{change:e.change},slot:"addonBefore",model:{value:e.filter.field,callback:function(t){e.$set(e.filter,"field",t)},expression:"filter.field"}},[e._l(e.fields,(function(t){return["string"==t.type?a("a-select-option",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")]):e._e()]}))],2),a("a-button",{attrs:{slot:"enterButton",icon:"search"},slot:"enterButton"})],1)],1)}),[],!1,null,null,null);t.a=a.exports},eb43:function(e,t,a){"use strict";a("231c")}}]);