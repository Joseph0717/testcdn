(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-671780f4"],{"58cc":function(e,t,a){},"71e0":function(e,t,a){},7569:function(e,t,a){e.exports=a.p+"static/img/localAvatar.37c3ea6b.png"},"80c1":function(e,t,a){"use strict";a.r(t);var s=a("5530"),o=(a("d9e2"),a("7db0"),a("d3b7"),a("e9c4"),a("ac1f"),a("1276"),a("d81d"),a("4e82"),a("5880")),i={name:"CommonLayout",computed:Object(s.a)({},Object(o.mapState)("setting",["footerLinks","copyright"]))},r=(a("f5f5"),a("2877")),n=(i=Object(r.a)(i,(function(){var e=this,t=e.$createElement;t=e._self._c||t;return t("div",{staticClass:"common-layout beauty-scroll"},[t("div",{staticClass:"content"},[e._t("default")],2)])}),[],!1,null,"40b542ca",null).exports,a("93d6")),l=a("b775"),c=a("89a5"),d=a("ca00"),u=a("2ef0"),m=a.n(u);u={name:"Login",i18n:a("9225"),components:{CommonLayout:i},data:function(){var e=this;return{form:{userName:"",password:"",verifyCode:""},rules:{userName:[{validator:function(t,a,s){""===a?s(new Error(e.$t("5"))):s()},trigger:"change",required:!0}],password:[{validator:function(t,a,s){""===a?s(new Error(e.$t("6"))):s()},trigger:"change",required:!0}],verifyCode:[{validator:function(t,a,s){""===a?s(new Error(e.$t("7"))):s()},trigger:"change",required:!0}]},loading:!1,spin:!1,verifydata:{},routerOptions:[{router:"root",children:[]}],langList:[{key:"CN",name:"简体中文",alias:"简体中文"},{key:"US",name:"English",alias:"English"}]}},computed:Object(s.a)(Object(s.a)({},Object(o.mapState)("setting",["lang","systemName"])),{},{langAlias:function(){var e=this;return this.langList.find((function(t){return t.key==e.lang})).alias}}),created:function(){this.getCode()},mounted:function(){window.addEventListener("keydown",this.keyDown)},destroyed:function(){window.removeEventListener("keydown",this.keyDown,!1)},methods:Object(s.a)(Object(s.a)(Object(s.a)({},Object(o.mapMutations)("account",["setUser","setPermissions","setRoles","setSystemType"])),Object(o.mapMutations)("setting",["setLang"])),{},{getCode:function(){var e=this;this.spin=!0,Object(n.d)(this.verifydata.key).then((function(t){1===t.data.code&&(e.verifydata=t.data.data,e.spin=!1)}))},onSubmit:function(){var e=this;this.$refs.form.validate((function(t){var a,s,o;t&&(e.loading=!0,t=e.form.userName,a=e.form.password,s=e.form.verifyCode,o=e.verifydata.key,Object(n.e)(t,a,"",s,o).then(e.afterLogin).catch((function(){e.loading=!1,e.$message.error(e.$t("8"))})))}))},keyDown:function(e){13!==e.keyCode&&"Enter"!==e.code&&"NumpadEnter"!==e.code||this.onSubmit()},afterLogin:function(e){var t,s=this;e=e.data;0===e.code?(this.loading=!1,this.$message.error(e.msg)):(t=e.data.token,Object(l.f)({token:t,expireAt:1}),this.setSystemType(e.data.defaultsystemtype),Object(n.n)(99).then((function(e){e=e.data;var t={name:e.data.user.userName,avatar:e.data.user.avatar||a("7569"),belongCode:e.data.user.belongCode,userType:e.data.user.userType,organizationList:e.data.user.organizationList},o=e.data.menus,i=(o.push({closable:!0,external:!1,hidden:!0,icon:"dashboard",id:"Dashboard",label:"Dashboard",labelEn:"Dashboard",newWindow:!1,opened:null,parentId:0,path:"/Dashboard",systemType:null,type:2,viewPath:"/Dashboard"}),s.setUser(t),s.setPermissions([{id:"form",operation:e.data.permissions}]),localStorage.setItem("systemtypes",JSON.stringify(e.data.systemtypes)),localStorage.setItem("currentOrg",e.data.user.organizationList.split(",")[0]),[]);o.map((function(e){i.push({id:e.id,parentId:e.parentId,router:"id"+e.id,path:e.path,name:e.label,labelEn:e.labelEn,icon:e.icon,invisible:e.hidden,authority:"form",type:e.type,systemType:e.systemType})})),i.sort(Object(d.a)("sort",!0)),s.routerOptions[0].children=Object(d.g)(m.a.cloneDeep(i)),Object(c.d)(s.routerOptions),s.$router.push("/Dashboard"),s.loading=!1})).catch((function(e){s.loading=!1,s.$message.error(s.$t("9"))})))}})},a("ee76"),i=Object(r.a)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("common-layout",[s("div",{staticClass:"main"},[s("div",{staticClass:"left animated fadeInLeft"},[s("div",{staticClass:"top"},[s("img",{attrs:{src:a("e9e9")}})])]),s("div",{staticClass:"center"}),s("div",{staticClass:"right animated fadeInRight"},[s("div",{staticClass:"top"},[s("a-dropdown",{staticClass:"lang header-item",staticStyle:{cursor:"pointer"}},[s("div",[s("a-icon",{staticStyle:{"vertical-align":"-2px"},attrs:{type:"global"}}),s("span",[e._v(" "+e._s(e.langAlias))])],1),s("a-menu",{attrs:{slot:"overlay","selected-keys":[e.lang]},on:{click:function(t){return e.setLang(t.key)}},slot:"overlay"},e._l(e.langList,(function(t){return s("a-menu-item",{key:t.key},[e._v(e._s(t.key+" "+t.name))])})),1)],1)],1),s("div",{staticClass:"login-box"},[s("a-form-model",{ref:"form",attrs:{model:e.form,rules:e.rules}},[s("div",{staticClass:"logo-box"},[s("h4",[e._v(e._s(e.systemName))])]),s("a-form-model-item",{staticStyle:{width:"100%"},attrs:{label:"",prop:"userName"}},[s("a-input",{attrs:{placeholder:e.$t("2"),size:"large"},model:{value:e.form.userName,callback:function(t){e.$set(e.form,"userName",t)},expression:"form.userName"}},[s("a-icon",{attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),s("a-form-model-item",{staticStyle:{width:"100%"},attrs:{label:"",prop:"password"}},[s("a-input-password",{attrs:{placeholder:e.$t("3"),size:"large"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}},[s("a-icon",{attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),s("a-form-model-item",{staticClass:"verify",staticStyle:{width:"100%"},attrs:{label:"",prop:"verifyCode"}},[s("a-input",{attrs:{placeholder:e.$t("4"),size:"large"},model:{value:e.form.verifyCode,callback:function(t){e.$set(e.form,"verifyCode",t)},expression:"form.verifyCode"}}),s("a-button",{attrs:{size:"large"},on:{click:e.getCode}},[e.verifydata.img?s("img",{staticStyle:{width:"70px"},attrs:{src:"data:image/png;base64,"+e.verifydata.img}}):e._e(),s("a-icon",{attrs:{type:"reload",spin:e.spin}})],1)],1),s("a-form-model-item",{staticStyle:{width:"100%"}},[s("a-button",{attrs:{type:"primary",size:"large",block:!0,loading:e.loading},on:{click:e.onSubmit,keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.onSubmit.apply(null,arguments)}}},[e._v(e._s(e.$t("1")))])],1)],1)],1)])])])}),[],!1,null,"67185cc1",null).exports;t.default=i},e9e9:function(e,t,a){e.exports=a.p+"static/img/ys-logo-2.d84c47ae.png"},ee76:function(e,t,a){"use strict";a("71e0")},f5f5:function(e,t,a){"use strict";a("58cc")}}]);